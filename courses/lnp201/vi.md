---
name: Giá»›i thiá»‡u lÃ½ thuyáº¿t vá» Lightning Network
goal: KhÃ¡m phÃ¡ Lightning Network tá»« gÃ³c Ä‘á»™ ká»¹ thuáº­t
objectives:
  - Hiá»ƒu vá» cÃ¡ch thá»©c hoáº¡t Ä‘á»™ng cá»§a cÃ¡c kÃªnh trong máº¡ng lÆ°á»›i.
  - LÃ m quen vá»›i cÃ¡c thuáº­t ngá»¯ nhÆ° HTLC, LNURL, vÃ  UTXO.
  - Hiá»ƒu vá» quáº£n lÃ½ thanh khoáº£n vÃ  phÃ­ trong Lightning Network.
  - Hiá»ƒu vá» Lightning Network nhÆ° má»™t máº¡ng lÆ°á»›i.
  - Hiá»ƒu vá» cÃ¡c á»©ng dá»¥ng lÃ½ thuyáº¿t cá»§a Lightning Network.
---

# HÃ nh trÃ¬nh Ä‘áº¿n Lá»›p thá»© hai cá»§a Bitcoin

KhÃ³a há»c nÃ y lÃ  má»™t khoÃ¡ há»c lÃ½ thuyáº¿t vá» cÃ¡ch thá»©c hoáº¡t Ä‘á»™ng cá»§a Lightning Network á»Ÿ gÃ³c Ä‘á»™ ká»¹ thuáº­t.

ChÃ o má»«ng báº¡n Ä‘áº¿n vá»›i tháº¿ giá»›i thÃº vá»‹ cá»§a Lightning Network, má»™t giáº£i phÃ¡p lá»›p thá»© hai cá»§a Bitcoin vá»«a phá»©c táº¡p vá»«a Ä‘áº§y tiá»m nÄƒng. ChÃºng ta sáº½ khÃ¡m phÃ¡ sÃ¢u cÃ¡c khÃ­a cáº¡nh ká»¹ thuáº­t cá»§a cÃ´ng nghá»‡ nÃ y, khÃ´ng táº­p trung vÃ o cÃ¡c hÆ°á»›ng dáº«n hay ká»‹ch báº£n sá»­ dá»¥ng cá»¥ thá»ƒ. Äá»ƒ hiá»ƒu sÃ¢u vá» khÃ³a há»c nÃ y, viá»‡c náº¯m vá»¯ng kiáº¿n thá»©c vá» Bitcoin lÃ  Ä‘iá»u cáº§n thiáº¿t. ÄÃ¢y lÃ  má»™t tráº£i nghiá»‡m Ä‘Ã²i há»i sá»± nghiÃªm tÃºc vÃ  táº­p trung. Báº¡n cÅ©ng cÃ³ thá»ƒ xem xÃ©t Ä‘á»ƒ Ä‘á»“ng thá»i tham gia khÃ³a há»c LN 202, nÆ¡i táº­p trung vÃ o khÃ­a cáº¡nh thá»±c hÃ nh trong hÃ nh trÃ¬nh khÃ¡m phÃ¡ Lightning Network. HÃ£y sáºµn sÃ ng cho má»™t hÃ nh trÃ¬nh cÃ³ thá»ƒ lÃ m thay Ä‘á»•i cÃ¡ch nhÃ¬n cá»§a báº¡n vá» há»‡ sinh thÃ¡i Bitcoin.

ChÃºc báº¡n khÃ¡m phÃ¡ vui váº»!

+++

# Kiáº¿n thá»©c cÆ¡ báº£n
<partId>32647d62-102b-509f-a3ba-ad1d6a4345f1</partId>

## Hiá»ƒu vá» Lightning Network
<chapterId>df6230ae-ff35-56ea-8651-8e65580730a8</chapterId>

![video en](https://youtu.be/QDQ8NG0l3hk)

Lightning Network (LN) lÃ  má»™t cÆ¡ sá»Ÿ háº¡ táº§ng thanh toÃ¡n lá»›p thá»© hai Ä‘Æ°á»£c xÃ¢y dá»±ng trÃªn máº¡ng lÆ°á»›i Bitcoin, cho phÃ©p thá»±c hiá»‡n giao dá»‹ch nhanh chÃ³ng vÃ  vá»›i chi phÃ­ tháº¥p. Äá»ƒ hiá»ƒu rÃµ cÃ¡ch thá»©c hoáº¡t Ä‘á»™ng cá»§a Lightning Network, chÃºng ta cáº§n pháº£i hiá»ƒu vá» kÃªnh thanh toÃ¡n vÃ  cÃ¡ch chÃºng hoáº¡t Ä‘á»™ng.

Má»™t kÃªnh thanh toÃ¡n Lightning lÃ  má»™t loáº¡i "lÃ n Ä‘Æ°á»ng riÃªng" giá»¯a hai ngÆ°á»i dÃ¹ng cho phÃ©p há» thá»±c hiá»‡n cÃ¡c giao dá»‹ch Bitcoin nhanh chÃ³ng vÃ  láº·p Ä‘i láº·p láº¡i. Khi má»™t kÃªnh Ä‘Æ°á»£c má»Ÿ, nÃ³ cÃ³ má»™t dung lÆ°á»£ng cá»‘ Ä‘á»‹nh, Ä‘Æ°á»£c xÃ¡c Ä‘á»‹nh trÆ°á»›c bá»Ÿi ngÆ°á»i dÃ¹ng. Dung lÆ°á»£ng nÃ y Ä‘áº¡i diá»‡n cho lÆ°á»£ng Bitcoin tá»‘i Ä‘a cÃ³ thá»ƒ Ä‘Æ°á»£c truyá»n trong kÃªnh táº¡i báº¥t ká»³ thá»i Ä‘iá»ƒm nÃ o.

KÃªnh thanh toÃ¡n lÃ  hai chiá»u, nghÄ©a lÃ  chÃºng cÃ³ hai "bÃªn". VÃ­ dá»¥, náº¿u Alice vÃ  Bob má»Ÿ má»™t kÃªnh thanh toÃ¡n, Alice cÃ³ thá»ƒ gá»­i Bitcoin cho Bob, vÃ  Bob cÅ©ng cÃ³ thá»ƒ gá»­i Bitcoin cho Alice. CÃ¡c giao dá»‹ch trong kÃªnh khÃ´ng thay Ä‘á»•i tá»•ng dung lÆ°á»£ng cá»§a kÃªnh, nhÆ°ng chÃºng thay Ä‘á»•i sá»± phÃ¢n bá»• dung lÆ°á»£ng Ä‘Ã³ giá»¯a Alice vÃ  Bob.

![explication](assets/chapitre1/0.webp)

Äá»ƒ má»™t giao dá»‹ch cÃ³ thá»ƒ diá»…n ra trong má»™t kÃªnh thanh toÃ¡n Lightning, ngÆ°á»i dÃ¹ng gá»­i tiá»n pháº£i cÃ³ Ä‘á»§ Bitcoin á»Ÿ phÃ­a cá»§a mÃ¬nh trong kÃªnh. Náº¿u Alice muá»‘n gá»­i 1 bitcoin cho Bob qua kÃªnh cá»§a há», cÃ´ áº¥y pháº£i cÃ³ Ã­t nháº¥t 1 bitcoin á»Ÿ phÃ­a cá»§a mÃ¬nh trong kÃªnh.

### Giá»›i háº¡n vÃ  cÃ¡ch hoáº¡t Ä‘á»™ng cá»§a cÃ¡c kÃªnh thanh toÃ¡n trÃªn Linghtning Network

Máº·c dÃ¹ dung lÆ°á»£ng cá»§a má»™t kÃªnh thanh toÃ¡n LN lÃ  cá»‘ Ä‘á»‹nh, Ä‘iá»u nÃ y khÃ´ng háº¡n cháº¿ tá»•ng sá»‘ giao dá»‹ch hoáº·c tá»•ng khá»‘i lÆ°á»£ng bitcoin cÃ³ thá»ƒ Ä‘Æ°á»£c truyá»n qua kÃªnh. VÃ­ dá»¥, náº¿u Alice vÃ  Bob cÃ³ má»™t kÃªnh vá»›i dung lÆ°á»£ng 1 bitcoin, há» cÃ³ thá»ƒ thá»±c hiá»‡n hÃ ng trÄƒm giao dá»‹ch 0.01 Bitcoin hoáº·c hÃ ng nghÃ¬n giao dá»‹ch 0.001 Bitcoin, miá»…n lÃ  tá»•ng dung lÆ°á»£ng cá»§a kÃªnh khÃ´ng bá»‹ vÆ°á»£t quÃ¡ táº¡i báº¥t ká»³ thá»i Ä‘iá»ƒm nÃ o.

Máº·c dÃ¹ cÃ³ nhá»¯ng háº¡n cháº¿ nÃ y, kÃªnh thanh toÃ¡n Lightning lÃ  má»™t cÃ¡ch hiá»‡u quáº£ Ä‘á»ƒ thá»±c hiá»‡n giao dá»‹ch bitcoin nhanh chÃ³ng vÃ  ráº». ChÃºng cho phÃ©p ngÆ°á»i dÃ¹ng gá»­i vÃ  nháº­n bitcoin mÃ  khÃ´ng cáº§n pháº£i tráº£ phÃ­ giao dá»‹ch cao hoáº·c chá» Ä‘á»£i thá»i gian xÃ¡c nháº­n lÃ¢u trÃªn máº¡ng lÆ°á»›i Bitcoin cÆ¡ sá»Ÿ.

TÃ³m láº¡i, kÃªnh thanh toÃ¡n Lightning cung cáº¥p má»™t giáº£i phÃ¡p máº¡nh máº½ cho nhá»¯ng ai muá»‘n thá»±c hiá»‡n giao dá»‹ch bitcoin nhanh chÃ³ng vÃ  ráº». Tuy nhiÃªn, viá»‡c hiá»ƒu rÃµ vá» cÃ¡ch thá»©c hoáº¡t Ä‘á»™ng vÃ  giá»›i háº¡n cá»§a chÃºng lÃ  cáº§n thiáº¿t Ä‘á»ƒ táº­n dá»¥ng triá»‡t Ä‘á»ƒ sá»©c máº¡nh cá»§a chÃºng.

![explication](assets/chapitre1/1.webp)

VÃ­ dá»¥:

- Alice cÃ³ 100.000 SAT
- Bob cÃ³ 30.000 SAT
ÄÃ¢y lÃ  tráº¡ng thÃ¡i hiá»‡n táº¡i cá»§a kÃªnh. Trong má»™t giao dá»‹ch, Alice quyáº¿t Ä‘á»‹nh gá»­i 40.000 SAT cho Bob. CÃ´ áº¥y cÃ³ thá»ƒ lÃ m nhÆ° váº­y vÃ¬ 40.000 < 100.000.
VÃ¬ váº­y, tráº¡ng thÃ¡i má»›i cá»§a kÃªnh lÃ :

- Alice 60.000 SAT
- Bob 70.000 SAT

```
Tráº¡ng thÃ¡i ban Ä‘áº§u cá»§a kÃªnh:
Alice (100.000 SAT) ============== Bob (30.000 SAT)

Sau khi Alice chuyá»ƒn 40.000 SAT cho Bob:
Alice (60.000 SAT) ============== Bob (70.000 SAT)

```
![explication](assets/chapitre1/2.webp)

BÃ¢y giá», náº¿u Bob muá»‘n gá»­i 80.000 SAT cho Alice, sá»‘ tiá»n nÃ y vÆ°á»£t quÃ¡ sá»‘ 70.000 SAT mÃ  Bob Ä‘ang cÃ³. Do khÃ´ng cÃ³ Ä‘á»§ thanh khoáº£n, anh áº¥y khÃ´ng thá»ƒ thá»±c hiá»‡n giao dá»‹ch nÃ y Ä‘Æ°á»£c. Tá»•ng dung lÆ°á»£ng tá»‘i Ä‘a cá»§a kÃªnh lÃ  130.000 SAT, vá»›i kháº£ nÄƒng chi tiÃªu tá»‘i Ä‘a Ä‘áº¡t 60.000 SAT cho Alice vÃ  70.000 SAT cho Bob.

![explication](assets/chapitre1/3.webp)

## Bitcoin, Ä‘á»‹a chá»‰, UTXO vÃ  giao dá»‹ch
<chapterId>0cfb7e6b-96f0-508b-9210-90bc1e28649d</chapterId>

![video](https://youtu.be/U9l5IVriCss)

Trong chÆ°Æ¡ng thá»© hai nÃ y, chÃºng ta sáº½ dÃ nh thá»i gian Ä‘á»ƒ nghiÃªn cá»©u cÃ¡ch má»™t giao dá»‹ch Bitcoin thá»±c sá»± hoáº¡t Ä‘á»™ng, Ä‘iá»u nÃ y sáº½ ráº¥t há»¯u Ã­ch Ä‘á»ƒ hiá»ƒu vá» Lightning Network. ChÃºng ta cÅ©ng tháº£o luáº­n sÆ¡ lÆ°á»£c vá» cÃ¡c khÃ¡i niá»‡m Ä‘á»‹a chá»‰ Ä‘a chá»¯ kÃ½, Ä‘iá»u nÃ y ráº¥t quan trá»ng Ä‘á»ƒ hiá»ƒu vá» viá»‡c má»Ÿ kÃªnh trÃªn thanh toÃ¡n trÃªn LN á»Ÿ chÆ°Æ¡ng tiáº¿p theo.

**- KhÃ³a riÃªng tÆ° > KhÃ³a cÃ´ng khai > Äá»‹a chá»‰:** Trong má»™t giao dá»‹ch, Alice gá»­i tiá»n cho Bob. Bob cung cáº¥p cho Alice má»™t Ä‘á»‹a chá»‰ Ä‘Æ°á»£c táº¡o ra tá»« khÃ³a cÃ´ng khai cá»§a mÃ¬nh. Alice, ngÆ°á»i trÆ°á»›c Ä‘Ã³ Ä‘Ã£ nháº­n tiá»n thÃ´ng qua má»™t Ä‘á»‹a chá»‰ tá»« khÃ³a cÃ´ng khai cá»§a mÃ¬nh, bÃ¢y giá» sá»­ dá»¥ng khÃ³a riÃªng tÆ° tÆ°Æ¡ng á»©ng Ä‘á»ƒ kÃ½ giao dá»‹ch vÃ  do Ä‘Ã³ má»Ÿ khÃ³a bitcoin tá»« Ä‘á»‹a chá»‰ Ä‘Ã³.
- Trong má»™t giao dá»‹ch Bitcoin, táº¥t cáº£ bitcoin pháº£i di chuyá»ƒn. ÄÆ°á»£c gá»i lÃ  UTXO (Unspend Transaction Output - Äáº§u ra chÆ°a chi tiÃªu), táº¥t cáº£ máº©u bitcoin á»Ÿ Ä‘áº§u vÃ o sáº½ Ä‘Æ°á»£c chuyá»ƒn Ä‘i, Ä‘á»ƒ sau Ä‘Ã³, pháº§n dÆ° sáº½ quay trá»Ÿ láº¡i vá»›i chá»§ sá»Ÿ há»¯u.
  Alice cÃ³ 0,002 BTC, Bob cÃ³ 0 BTC. Alice quyáº¿t Ä‘á»‹nh gá»­i 0,0015 BTC cho Bob. CÃ´ áº¥y sáº½ kÃ½ má»™t giao dá»‹ch Ä‘á»ƒ chi tiÃªu UTXO chá»©a 0,002 BTC nÆ¡i mÃ  0,0015 BTC sáº½ Ä‘i Ä‘áº¿n vÃ­ cá»§a Bob vÃ  0,0005 BTC tiá»n dÆ° (tiá»n thá»‘i) sáº½ quay trá»Ÿ láº¡i vÃ­ cá»§a cÃ´ áº¥y.

![explication](assets/chapitre2/0.webp)

á» Ä‘Ã¢y, tá»« má»™t UTXO (Alice cÃ³ má»™t UTXO chá»©a 0,002 BTC trÃªn má»™t Ä‘á»‹a chá»‰), thÃ´ng qua giao dá»‹ch, Ä‘Ã£ táº¡o ra 2 UTXO (Bob cÃ³ má»™t UTXO chá»©a 0,0015 BTC vÃ  Alice cÃ³ má»™t UTXO má»›i (Ä‘á»™c láº­p vá»›i cÃ¡i trÆ°á»›c) chá»©a 0,0005 BTC).

```
Alice (0,002 BTC)
  |
  V
Giao dá»‹ch Bitcoin (UTXO cÅ©: 0,002 BTC)
  |
  |----> Bob (UTXO má»›i: 0,0015 BTC)
  |
  V
Alice (UTXO má»›i: 0,0005 BTC)
```

Trong LN, vÃ­ Ä‘a chá»¯ kÃ½ Ä‘Æ°á»£c sá»­ dá»¥ng. Do Ä‘Ã³, cáº§n 2 chá»¯ kÃ½ Ä‘á»ƒ má»Ÿ khÃ³a tiá»n, tá»©c lÃ , cáº§n hai khÃ³a riÃªng tÆ° Ä‘á»ƒ di chuyá»ƒn tiá»n. Äiá»u nÃ y nghÄ©a lÃ  Alice vÃ  Bob, cáº£ hai cÃ¹ng pháº£i Ä‘á»“ng Ã½ Ä‘á»ƒ má»Ÿ khÃ³a tiá»n (UTXO). Cá»¥ thá»ƒ trong LN, Ä‘Ã³ lÃ  cÃ¡c giao dá»‹ch 2/2, vÃ¬ váº­y Ä‘Ã²i há»i pháº£i cÃ³ cáº£ hai chá»¯ kÃ½ tá»« hai bÃªn cá»§a kÃªnh thanh toÃ¡n, khÃ´ng giá»‘ng nhÆ° Ä‘a chá»¯ kÃ½ 2/3 hoáº·c 3/5 nÆ¡i chá»‰ cáº§n má»™t tá»• há»£p nháº¥t Ä‘á»‹nh trong tá»•ng sá»‘ lÆ°á»£ng khoÃ¡ hoÃ n chá»‰nh lÃ  Ä‘á»§ (2 trong 3 hoáº·c 3 trong 5).

![explication](assets/chapitre2/1.webp)

# Má»Ÿ vÃ  Ä‘Ã³ng kÃªnh
<partId>900b5b6b-ccd0-5b2f-9424-4b191d0e935d</partId>

## Má»Ÿ kÃªnh
<chapterId>96243eb0-f6b5-5b68-af1f-fffa0cc16bfe</chapterId>

![video](https://youtu.be/Ty80WuN5X-g)

BÃ¢y giá», chÃºng ta sáº½ tÃ¬m hiá»ƒu ká»¹ lÆ°á»¡ng hÆ¡n vá» viá»‡c má»Ÿ kÃªnh vÃ  cÃ¡ch thá»©c thá»±c hiá»‡n viá»‡c Ä‘Ã³ thÃ´ng qua má»™t giao dá»‹ch trÃªn máº¡ng lÆ°á»›i Bitcoin.

Lightning Network cÃ³ cÃ¡c cáº¥p Ä‘á»™ giao tiáº¿p khÃ¡c nhau:

- Giao tiáº¿p P2P (giao thá»©c LN)
- KÃªnh thanh toÃ¡n (giao thá»©c LN)
- Giao dá»‹ch Bitcoin (giao thá»©c Bitcoin)

![explication](assets/chapitre3/0.webp)

Äá»ƒ má»Ÿ má»™t kÃªnh, hai bÃªn liÃªn láº¡c qua má»™t kÃªnh giao tiáº¿p:

- Alice: "Xin chÃ o, tÃ´i muá»‘n má»Ÿ má»™t kÃªnh thanh toÃ¡n!"
- Bob: "Ok, Ä‘Ã¢y lÃ  Ä‘á»‹a chá»‰ cÃ´ng khai cá»§a tÃ´i."

![explication](assets/chapitre3/1.webp)

Alice giá» Ä‘Ã¢y cÃ³ 2 Ä‘á»‹a chá»‰ cÃ´ng khai Ä‘á»ƒ táº¡o má»™t Ä‘á»‹a chá»‰ Ä‘a chá»¯ kÃ½ 2/2. CÃ´ áº¥y cÃ³ thá»ƒ thá»±c hiá»‡n má»™t giao dá»‹ch bitcoin Ä‘á»ƒ gá»­i tiá»n vÃ o Ä‘Ã³.

Giáº£ sá»­ Alice cÃ³ má»™t UTXO chá»©a 0,002 BTC vÃ  cÃ´ áº¥y muá»‘n má»Ÿ má»™t kÃªnh vá»›i Bob vÃ  Ä‘Ã³ng gÃ³p vÃ o 0,0013 BTC cá»§a mÃ¬nh. CÃ´ áº¥y sáº½ táº¡o má»™t giao dá»‹ch vá»›i 2 UTXO lÃ m Ä‘áº§u ra:

- má»™t UTXO chá»©a 0,0013 Ä‘áº¿n Ä‘á»‹a chá»‰ multi-sig 2/2 cá»§a kÃªnh
- má»™t UTXO chá»©a 0,0007 Ä‘áº¿n má»™t trong nhá»¯ng Ä‘á»‹a chá»‰ tiá»n thá»‘i cá»§a cÃ´ áº¥y (UTXO tiá»n thá»‘i).

Giao dá»‹ch nÃ y chÆ°a Ä‘Æ°á»£c cÃ´ng khai vÃ¬ náº¿u cÃ´ng khai á»Ÿ giai Ä‘oáº¡n nÃ y, Alice pháº£i tin tÆ°á»Ÿng vÃ o Bob Ä‘á»ƒ cÃ³ thá»ƒ má»Ÿ khÃ³a Ä‘Æ°á»£c tiá»n tá»« Ä‘á»‹a chá»‰ Ä‘a chá»¯ kÃ½.

Váº­y khi Ä‘Ã³ pháº£i lÃ m tháº¿ nÃ o?

Alice sáº½ táº¡o má»™t giao dá»‹ch thá»© hai Ä‘Æ°á»£c gá»i lÃ  "giao dá»‹ch rÃºt tiá»n" trÆ°á»›c khi cÃ´ng bá»‘ viá»‡c gá»­i tiá»n vÃ o Ä‘á»‹a chá»‰ Ä‘a chá»¯ kÃ½.

![explication](assets/chapitre3/2.webp)

Giao dá»‹ch rÃºt tiá»n sáº½ chi tiÃªu tiá»n tá»« Ä‘á»‹a chá»‰ Ä‘a chá»¯ kÃ½ Ä‘áº¿n má»™t Ä‘á»‹a chá»‰ cá»§a cÃ´ áº¥y (Ä‘iá»u nÃ y Ä‘Æ°á»£c thá»±c hiá»‡n trÆ°á»›c khi má»i thá»© Ä‘Æ°á»£c cÃ´ng bá»‘).
Má»™t khi cáº£ hai giao dá»‹ch Ä‘Æ°á»£c xÃ¢y dá»±ng xong, Alice thÃ´ng bÃ¡o cho Bob ráº±ng viá»‡c nÃ y Ä‘Ã£ hoÃ n táº¥t vÃ  yÃªu cáº§u anh áº¥y kÃ½ má»™t chá»¯ kÃ½ vá»›i khÃ³a cÃ´ng khai cá»§a mÃ¬nh, giáº£i thÃ­ch vá»›i anh áº¥y ráº±ng báº±ng cÃ¡ch Ä‘Ã³ cÃ´ áº¥y cÃ³ thá»ƒ láº¥y láº¡i tiá»n cá»§a mÃ¬nh náº¿u cÃ³ Ä‘iá»u gÃ¬ Ä‘Ã³ khÃ´ng á»•n xáº£y ra. Bob Ä‘á»“ng Ã½ vÃ¬ anh áº¥y khÃ´ng pháº£i lÃ  ngÆ°á»i gian láº­n.

Alice giá» Ä‘Ã¢y cÃ³ thá»ƒ tá»± mÃ¬nh láº¥y láº¡i tiá»n, vÃ¬ cÃ´ áº¥y Ä‘Ã£ cÃ³ chá»¯ kÃ½ cá»§a Bob. CÃ´ áº¥y cÃ´ng bá»‘ cÃ¡c giao dá»‹ch. KÃªnh giá» Ä‘Ã¢y Ä‘Ã£ Ä‘Æ°á»£c má»Ÿ vá»›i 0,0013 BTC (130.000 SAT) á»Ÿ phÃ­a Alice.

![explication](assets/chapitre3/3.webp)

## Giao dá»‹ch Lightning vÃ  giao dá»‹ch cam káº¿t
<chapterId>7d3fd135-129d-5c5a-b306-d5f2f1e63340</chapterId>

![video](https://youtu.be/dzPMGiR_JSE)

![cover](assets/chapitre4/1.webp)

BÃ¢y giá», hÃ£y phÃ¢n tÃ­ch vá» giao dá»‹ch cam káº¿t Ä‘á»ƒ biáº¿t Ä‘iá»u gÃ¬ Ä‘ang thá»±c sá»± xáº£y ra á»Ÿ phÃ­a sau khi bitcoin Ä‘Æ°á»£c chuyá»ƒn tá»« bÃªn nÃ y sang bÃªn khÃ¡c trÃªn má»™t kÃªnh thanh toÃ¡n LN. Giao dá»‹ch rÃºt tiá»n/Ä‘Ã³ng kÃªnh trÃªn chuá»—i Ä‘áº¡i diá»‡n cho tráº¡ng thÃ¡i cá»§a kÃªnh, Ä‘áº£m báº£o ai sá»Ÿ há»¯u tiá»n sau má»—i láº§n chuyá»ƒn tiá»n. VÃ¬ váº­y, sau má»™t giao dá»‹ch LN, sáº½ cÃ³ sá»± cáº­p nháº­t vá» giao dá»‹ch cam káº¿t nÃ y giá»¯a hai bÃªn. Cáº£ Alice vÃ  Bob cÃ¹ng táº¡o ra má»™t giao dá»‹ch vá»›i tráº¡ng thÃ¡i hiá»‡n táº¡i cá»§a kÃªnh Ä‘á»ƒ sá»­ dá»¥ng trong trÆ°á»ng há»£p Ä‘Ã³ng kÃªnh:

- Alice má»Ÿ má»™t kÃªnh vá»›i Bob vá»›i 130.000 SAT tá»« phÃ­a cá»§a cÃ´ áº¥y. Giao dá»‹ch rÃºt tiá»n Ä‘Æ°á»£c cáº£ hai cháº¥p nháº­n nÃ³i ráº±ng trong trÆ°á»ng há»£p Ä‘Ã³ng kÃªnh, 130.000 SAT sáº½ Ä‘i Ä‘áº¿n vÃ­ cá»§a Alice, vÃ  Bob Ä‘á»“ng Ã½ vÃ¬ nÃ³ cÃ´ng báº±ng.

![cover](assets/chapitre4/2.webp)

- Alice gá»­i 30.000 SAT cho Bob. Giá» Ä‘Ã¢y cÃ³ má»™t giao dá»‹ch rÃºt tiá»n má»›i nÃ³i ráº±ng trong trÆ°á»ng há»£p Ä‘Ã³ng kÃªnh, Alice sáº½ nháº­n Ä‘Æ°á»£c 100.000 SAT vÃ  Bob 30.000 SAT. Cáº£ hai Ä‘á»“ng Ã½ vÃ¬ nÃ³ cÃ´ng báº±ng.

![cover](assets/chapitre4/3.webp)

- Alice gá»­i 10.000 SAT cho Bob, vÃ  má»™t giao dá»‹ch rÃºt tiá»n má»›i Ä‘Æ°á»£c táº¡o ra nÃ³i ráº±ng Alice sáº½ nháº­n Ä‘Æ°á»£c 90.000 SAT vÃ  Bob 40.000 SAT trong trÆ°á»ng há»£p Ä‘Ã³ng kÃªnh. Cáº£ hai Ä‘á»“ng Ã½ vÃ¬ nÃ³ cÃ´ng báº±ng.

![cover](assets/chapitre4/4.webp)

```
Tráº¡ng thÃ¡i ban Ä‘áº§u cá»§a kÃªnh:
Alice (130.000 SAT) =============== Bob (0 SAT)

Sau láº§n chuyá»ƒn tiá»n Ä‘áº§u tiÃªn:
Alice (100.000 SAT) =============== Bob (30.000 SAT)

Sau láº§n chuyá»ƒn tiá»n thá»© hai:
Alice (90.000 SAT) =============== Bob (40.000 SAT)
```

Tiá»n khÃ´ng thá»±c sá»± Ä‘Æ°á»£c chuyá»ƒn qua láº¡i, nhÆ°ng sá»‘ dÆ° cuá»‘i cÃ¹ng cá»§a má»—i bÃªn Ä‘Æ°á»£c cáº­p nháº­t thÃ´ng qua má»™t giao dá»‹ch on-chain trÃªn máº¡ng lÆ°á»›i Bitcoin Ä‘Æ°á»£c kÃ½ káº¿t nhÆ°ng khÃ´ng Ä‘Æ°á»£c cÃ´ng bá»‘. Do Ä‘Ã³, giao dá»‹ch rÃºt tiá»n lÃ  má»™t giao dá»‹ch cam káº¿t. CÃ¡c giao dá»‹ch chuyá»ƒn satoshi qua láº¡i cung lÃ  má»™t giao dá»‹ch cam káº¿t, cáº­p nháº­t sá»‘ dÆ° cá»§a hai bÃªn.

## Giao dá»‹ch cam káº¿t
<chapterId>f2f61e5b-badb-5947-9a81-7aa530b44e59</chapterId>

![video](https://youtu.be/veCs39uVFUk)

Náº¿u giao dá»‹ch cam káº¿t quyáº¿t Ä‘á»‹nh tráº¡ng thÃ¡i kÃªnh vá»›i tÃ­nh thanh khoáº£n táº¡i thá»i Ä‘iá»ƒm X, liá»‡u chÃºng ta cÃ³ thá»ƒ gian láº­n báº±ng cÃ¡ch cÃ´ng bá»‘ má»™t tráº¡ng thÃ¡i cÅ©? CÃ¢u tráº£ lá»i lÃ  cÃ³, bá»Ÿi vÃ¬ chÃºng ta Ä‘Ã£ cÃ³ chá»¯ kÃ½ trÆ°á»›c cá»§a cáº£ hai bÃªn trong giao dá»‹ch chÆ°a Ä‘Æ°á»£c cÃ´ng bá»‘.

![instruction](assets/Chapitre5/0.webp)

Äá»ƒ giáº£i quyáº¿t váº¥n Ä‘á» nÃ y, Ä‘á»™ phá»©c táº¡p sáº½ pháº£i tÄƒng lÃªn:

- **Thá»i gian khoÃ¡ - Timelock** = quá»¹ bá»‹ khÃ³a cho Ä‘áº¿n khá»‘i N
- **KhoÃ¡ huá»· bá» - Revocation key** = bÃ­ máº­t cá»§a Alice vÃ  bÃ­ máº­t cá»§a Bob'

Hai yáº¿u tá»‘ nÃ y Ä‘Æ°á»£c thÃªm vÃ o giao dá»‹ch cam káº¿t. Káº¿t quáº£ lÃ , Alice pháº£i chá» Ä‘áº¿n khi káº¿t thÃºc thá»i gian khoÃ¡, vÃ  báº¥t ká»³ ai giá»¯ chÃ¬a khÃ³a há»§y bá» cÃ³ thá»ƒ di chuyá»ƒn tiá»n mÃ  khÃ´ng cáº§n chá» Ä‘áº¿n háº¿t thá»i gian khoÃ¡. Náº¿u Alice cá»‘ gáº¯ng gian láº­n, Bob sá»­ dá»¥ng chÃ¬a khÃ³a há»§y bá» Ä‘á»ƒ Äƒn cáº¯p vÃ  trá»«ng pháº¡t Alice.

![instruction](assets/Chapitre5/1.webp)

BÃ¢y giá» (vÃ  trong thá»±c táº¿) giao dá»‹ch cam káº¿t khÃ´ng giá»‘ng nhau Ä‘á»‘i vá»›i Alice vÃ  Bob, chÃºng Ä‘á»‘i xá»©ng nhÆ°ng má»—i ngÆ°á»i cÃ³ nhá»¯ng rÃ ng buá»™c khÃ¡c nhau, há» trao cho nhau bÃ­ máº­t cá»§a mÃ¬nh Ä‘á»ƒ táº¡o ra chÃ¬a khÃ³a há»§y bá» cho giao dá»‹ch cam káº¿t trÆ°á»›c Ä‘Ã³. VÃ¬ váº­y, ngay tá»« khi táº¡o táº¡o kÃªnh vá»›i Bob, vÃ  Ä‘Ã³ng gÃ³p vÃ o 130.000 SAT á»Ÿ phÃ­a mÃ¬nh, Alice Ä‘áº·t má»™t thá»i gian khoÃ¡ Ä‘á»ƒ ngÄƒn cáº£n viá»‡c cÃ´ áº¥y láº­p tá»©c thu há»“i tiá»n cá»§a mÃ¬nh, cÃ´ áº¥y pháº£i chá» Ä‘á»£i má»™t khoáº£ng thá»i gian. ChÃ¬a khÃ³a há»§y bá» cÃ³ thá»ƒ má»Ÿ khÃ³a tiá»n nhÆ°ng chá»‰ Alice cÃ³ nÃ³ (giao dá»‹ch cam káº¿t cá»§a Alice). Má»™t khi cÃ³ má»™t giao dá»‹ch chuyá»ƒn tiá»n, Alice sáº½ cung cáº¥p bÃ­ máº­t cÅ© cá»§a mÃ¬nh cho Bob vÃ  do Ä‘Ã³ Bob cÃ³ thá»ƒ khoÃ¡ kÃªnh á»Ÿ tráº¡ng thÃ¡i trÆ°á»›c Ä‘Ã³ trong trÆ°á»ng há»£p Alice cá»‘ gáº¯ng gian láº­n (do Ä‘Ã³, Alice bá»‹ trá»«ng pháº¡t).

![instruction](assets/Chapitre5/2.webp)

TÆ°Æ¡ng tá»±, Bob sáº½ cung cáº¥p bÃ­ máº­t cá»§a mÃ¬nh cho Alice. VÃ¬ váº­y, náº¿u anh ta cá»‘ gáº¯ng gian láº­n, Alice cÃ³ thá»ƒ trá»«ng pháº¡t anh ta. Hoáº¡t Ä‘á»™ng nÃ y Ä‘Æ°á»£c láº·p láº¡i cho má»—i giao dá»‹ch cam káº¿t má»›i. Má»—i láº§n sáº½ cÃ³ má»™t bÃ­ máº­t má»›i vÃ  má»™t khoÃ¡ thu há»“i má»›i. VÃ¬ váº­y, cho má»—i giao dá»‹ch má»›i, giao dá»‹ch cam káº¿t trÆ°á»›c Ä‘Ã³ pháº£i Ä‘Æ°á»£c há»§y bá» báº±ng cÃ¡ch cung cáº¥p bÃ­ máº­t há»§y bá». NhÆ° váº­y náº¿u Alice hoáº·c Bob cá»‘ gáº¯ng gian láº­n, ngÆ°á»i kia cÃ³ thá»ƒ hÃ nh Ä‘á»™ng trÆ°á»›c (nhá» vÃ o thá»i gian khoÃ¡) vÃ  do Ä‘Ã³ trÃ¡nh Ä‘Æ°á»£c gian láº­n. Trong giao dá»‹ch #3, bÃ­ máº­t cá»§a giao dá»‹ch #2 Ä‘Æ°á»£c cung cáº¥p Ä‘á»ƒ cho phÃ©p Alice vÃ  Bob tá»± vá»‡ chá»‘ng láº¡i sá»± gian láº­n cá»§a Ä‘á»‘i phÆ°Æ¡ng.

![instruction](assets/Chapitre5/3.webp)

NgÆ°á»i táº¡o giao dá»‹ch vá»›i thá»i gian khoÃ¡ (ngÆ°á»i gá»­i tiá»n) chá»‰ cÃ³ thá»ƒ sá»­ dá»¥ng chÃ¬a khÃ³a há»§y bá» sau khi háº¿t thá»i gian khoÃ¡. Tuy nhiÃªn, ngÆ°á»i nháº­n tiá»n cÃ³ thá»ƒ sá»­ dá»¥ng nÃ³ trÆ°á»›c khi háº¿t thá»i gian khoÃ¡ trong trÆ°á»ng há»£p phÃ¡t hiá»‡n gian láº­n tá»« phÃ­a bÃªn kia cá»§a kÃªnh LN. Cá»¥ thá»ƒ, chÃºng ta sáº½ Ä‘i sÃ¢u vÃ o chi tiáº¿t cÃ¡c cÆ¡ cháº¿ báº£o vá»‡ chá»‘ng láº¡i gian láº­n tá»« cÃ¡c Ä‘á»‘i tÃ¡c trong cÃ¡c kÃªnh thanh toÃ¡n.

## ÄÃ³ng KÃªnh
<chapterId>29a72223-2249-5400-96f0-3756b1629bc2</chapterId>

![video](https://youtu.be/zmAa2fj_V7w)

ChÃºng ta sáº½ tÃ¬m hiá»ƒu cÃ¡ch Ä‘Ã³ng kÃªnh thanh toÃ¡n thÃ´ng qua má»™t giao dá»‹ch Bitcoin, cÃ³ thá»ƒ cÃ³ cÃ¡c hÃ¬nh thá»©c khÃ¡c nhau tÃ¹y thuá»™c vÃ o tá»«ng trÆ°á»ng há»£p. CÃ³ 3 kiá»ƒu Ä‘Ã³ng kÃªnh:

- **Loáº¡i tá»‘t:** Ä‘Ã³ng kÃªnh kiá»ƒu Ä‘á»“ng thuáº­n
- **Loáº¡i thÃ´ báº¡o:** Ä‘Ã³ng kÃªnh kiá»ƒu cÆ°á»¡ng cháº¿ (khÃ´ng há»£p tÃ¡c)
- **Loáº¡i chá»‘ng gian láº­n:** Ä‘Ã³ng kÃªnh kiá»ƒu trá»«ng pháº¡t káº» gian láº­n

![instruction](assets/chapitre6/1.webp)
![instruction](assets/chapitre6/0.webp)

### ÄÃ³ng kÃªnh theo kiá»ƒu Ä‘á»“ng thuáº­n
Hai bÃªn giao tiáº¿p vá»›i nhau vÃ  Ä‘á»“ng Ã½ Ä‘Ã³ng kÃªnh. Há» dá»«ng táº¥t cáº£ cÃ¡c giao dá»‹ch vÃ  xÃ¡c nháº­n tráº¡ng thÃ¡i cuá»‘i cÃ¹ng cá»§a kÃªnh. Há» thá»‘ng nháº¥t vá» phÃ­ máº¡ng (ngÆ°á»i má»Ÿ kÃªnh sáº½ tráº£ phÃ­ Ä‘Ã³ng kÃªnh). Khi Ä‘Ã³, há» táº¡o giao dá»‹ch Ä‘Ã³ng kÃªnh. Giao dá»‹ch Ä‘Ã³ng kÃªnh khÃ¡c vá»›i cÃ¡c giao dá»‹ch cam káº¿t vÃ¬ khÃ´ng cÃ³ thá»i gian khoÃ¡ vÃ  khÃ³a huá»· bá». Giao dá»‹ch sau Ä‘Ã³ Ä‘Æ°á»£c cÃ´ng bá»‘ lÃªn máº¡ng chÃ­nh Bitcoin vÃ  Alice vÃ  Bob nháº­n Ä‘Æ°á»£c sá»‘ dÆ° tÆ°Æ¡ng á»©ng cá»§a há». ÄÃ³ng kÃªnh theo kiá»ƒu nÃ y nhanh (vÃ¬ khÃ´ng cÃ³ thá»i gian khoÃ¡) vÃ  nÃ³i chung lÃ  khÃ´ng tá»‘n kÃ©m.

![instruction](assets/chapitre6/3.webp)

### ÄÃ³ng kÃªnh theo kiá»ƒu cÆ°á»¡ng cháº¿

Alice muá»‘n Ä‘Ã³ng kÃªnh, nhÆ°ng Bob khÃ´ng pháº£n há»“i vÃ¬ anh ta Ä‘ang offline (máº¥t internet hoáº·c máº¥t Ä‘iá»‡n). Alice sau Ä‘Ã³ sáº½ cÃ´ng bá»‘ giao dá»‹ch cam káº¿t gáº§n Ä‘Ã¢y nháº¥t (cÃ¡i cuá»‘i cÃ¹ng). Giao dá»‹ch Ä‘Æ°á»£c cÃ´ng bá»‘ vÃ  thá»i gian khoÃ¡ Ä‘Æ°á»£c kÃ­ch hoáº¡t. PhÃ­ giao dá»‹ch Ä‘Ã£ Ä‘Æ°á»£c xÃ¡c Ä‘á»‹nh khi giao dá»‹ch cam káº¿t nÃ y Ä‘Æ°á»£c táº¡o ra. Tuy nhiÃªn, do MemPool vÃ  máº¡ng lÆ°á»›i Ä‘Ã£ cÃ³ sá»± thay Ä‘á»•i ká»ƒ tá»« lÃºc Ä‘Ã³, nÃªn giao thá»©c sáº½ máº·c Ä‘á»‹nh nhÃ¢n 5 láº§n sá»‘ phÃ­ Ä‘Ã£ xÃ¡c Ä‘á»‹nh lÃºc ban Ä‘áº§u. VÃ­ dá»¥, táº¡i thá»i Ä‘iá»ƒm táº¡o giao dá»‹ch cam káº¿t cuá»‘i cÃ¹ng, phÃ­ giao dá»‹ch Ä‘Æ°á»£c Ä‘áº·t lÃ  10 SAT, táº¡i thá»i Ä‘iá»ƒm cÃ´ng bá»‘ giao dá»‹ch Ä‘Ã³ng kÃªnh, phÃ­a giao dá»‹ch sáº½ lÃ  50 SAT. Táº¡i thá»i Ä‘iá»ƒm cÃ´ng bá»‘ giao dá»‹ch Ä‘Ã³ng kÃªnh cÆ°á»¡ng cháº¿, náº¿u máº¡ng lÆ°á»›i Ä‘ang cÃ³ má»©c phÃ­:

- 1 SAT = tráº£ há»› 50 láº§n
- 100 SAT = tráº£ thiáº¿u 2 láº§n

Äiá»u nÃ y khiáº¿n viá»‡c Ä‘Ã³ng kÃªnh kiá»ƒu cÆ°á»¡ng bá»©c máº¥t thá»i gian hÆ¡n (thá»i gian khoÃ¡) vÃ  Ä‘áº·c biá»‡t lÃ  khÃ´ng cÃ³ sá»± cháº¯c cháº¯n vá» phÃ­ dáº«n Ä‘áº¿n gáº·p khÃ³ khÄƒn trong viá»‡c Ä‘Æ°á»£c thá»£ Ä‘Ã o Ä‘Æ°á»£c xá»­ lÃ½.

![instruction](assets/chapitre6/4.webp)

### ÄÃ³ng kÃªnh kiá»ƒu trá»«ng pháº¡t káº» gian láº­n

Alice cá»‘ gáº¯ng gian láº­n báº±ng cÃ¡ch cÃ´ng bá»‘ má»™t giao dá»‹ch cam káº¿t cÅ©. NhÆ°ng Bob giÃ¡m sÃ¡t MemPool vÃ  tÃ¬m xem liá»‡u cÃ³ giao dá»‹ch nÃ o Ä‘ang cá»‘ gáº¯ng cÃ´ng bá»‘ má»™t giao dá»‹ch cam káº¿t cÅ© hay khÃ´ng. Náº¿u tÃ¬m tháº¥y báº¥t ká»³ giao dá»‹ch nÃ o nhÆ° váº­y, anh ta sáº½ sá»­ dá»¥ng khÃ³a huá»· bá» Ä‘á»ƒ trá»«ng pháº¡t Alice vÃ  láº¥y táº¥t cáº£ sá»‘ SAT tá»« kÃªnh giá»¯a hai ngÆ°á»i.

![instruction](assets/chapitre6/5.webp)

Káº¿t luáº­n, viá»‡c Ä‘Ã³ng kÃªnh trong Lightning Network lÃ  má»™t bÆ°á»›c ráº¥t quan trá»ng vÃ  nÃ³ cÃ³ thá»ƒ diá»…n ra theo nhiá»u hÃ¬nh thá»©c. Trong trÆ°á»ng há»£p Ä‘Ã³ng kÃªnh Ä‘á»“ng thuáº­n, cáº£ hai bÃªn giao tiáº¿p vÃ  Ä‘á»“ng Ã½ vá» tráº¡ng thÃ¡i cuá»‘i cÃ¹ng cá»§a kÃªnh. ÄÃ¢y lÃ  lá»±a chá»n nhanh nháº¥t vÃ  Ã­t tá»‘n kÃ©m nháº¥t. Máº·t khÃ¡c, Ä‘Ã³ng kÃªnh kiá»ƒu cÆ°á»¡ng cháº¿ xáº£y ra khi má»™t bÃªn khÃ´ng pháº£n há»“i. ÄÃ¢y lÃ  má»™t tÃ¬nh huá»‘ng tá»‘n kÃ©m vÃ  máº¥t thá»i gian hÆ¡n do phÃ­ giao dá»‹ch khÃ´ng thá»ƒ Ä‘oÃ¡n trÆ°á»›c vÃ  pháº£i kÃ­ch hoáº¡t thá»i gian khoÃ¡. Cuá»‘i cÃ¹ng, náº¿u má»™t bÃªn tham gia cá»‘ gáº¯ng gian láº­n báº±ng cÃ¡ch cÃ´ng bá»‘ má»™t giao dá»‹ch cam káº¿t cÅ©, há» cÃ³ thá»ƒ bá»‹ pháº¡t vÃ  bá»‹ máº¥t toÃ n bá»™  sá»‘ SAT cá»§a mÃ¬nh trong kÃªnh. Do Ä‘Ã³, viá»‡c hiá»ƒu rÃµ nhá»¯ng cÆ¡ cháº¿ nÃ y lÃ  ráº¥t quan trá»ng Ä‘á»ƒ sá»­ dá»¥ng Lightning Network má»™t cÃ¡ch hiá»‡u quáº£ vÃ  cÃ´ng báº±ng.

# Má»™t máº¡ng lÆ°á»›i thanh khoáº£n
<partId>a873f1cb-751f-5f4a-9ed7-25092bfdef11</partId>

## Lightning Network
<chapterId>45a7252c-fa4f-554b-b8bb-47449532918e</chapterId>

![video](https://youtu.be/44oBdNdXtEQ)

Trong chÆ°Æ¡ng thá»© báº£y nÃ y, chÃºng ta sáº½ nghiÃªn cá»©u cÃ¡ch Lightning Network hoáº¡t Ä‘á»™ng nhÆ° má»™t máº¡ng lÆ°á»›i cÃ¡c kÃªnh thanh toÃ¡n vÃ  cÃ¡ch cÃ¡c khoáº£n thanh toÃ¡n Ä‘Æ°á»£c Ä‘á»‹nh tuyáº¿n tá»« Ä‘iá»ƒm nguá»“n cho Ä‘áº¿n Ä‘iá»ƒm Ä‘Ã­ch cá»§a chÃºng.

![cover](assets/Chapitre7/0.webp)
![cover](assets/Chapitre7/1.webp)

Lightning Network lÃ  má»™t máº¡ng lÆ°á»›i cÃ¡c kÃªnh thanh toÃ¡n. HÃ ng ngÃ n Ä‘á»‘i tÃ¡c ngang hÃ ng vá»›i cÃ¡c kÃªnh thanh khoáº£n riÃªng cá»§a há» Ä‘Æ°á»£c káº¿t ná»‘i vá»›i nhau, vÃ  tá»« Ä‘Ã³ cÃ¡c kÃªnh nÃ y Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ thá»±c hiá»‡n cÃ¡c giao dá»‹ch giá»¯a cÃ¡c Ä‘á»‘i tÃ¡c khÃ´ng cÃ³ káº¿t ná»‘i trá»±c tiáº¿p vá»›i nhau. Thanh khoáº£n cá»§a cÃ¡c kÃªnh nÃ y khÃ´ng thá»ƒ Ä‘Æ°á»£c chuyá»ƒn sang cÃ¡c kÃªnh thanh khoáº£n khÃ¡c.

VÃ­ dá»¥ `Alice -> Eden -> Bob`. Satoshis khÃ´ng di chuyá»ƒn tá»« `Alice -> Bob`, mÃ  tá»« `Alice -> Eden` vÃ  tá»« `Eden -> Bob`.

VÃ¬ váº­y, má»—i ngÆ°á»i vÃ  má»—i kÃªnh cÃ³ thanh khoáº£n khÃ¡c nhau. Äá»ƒ thá»±c hiá»‡n má»™t khoáº£n thanh toÃ¡n, báº¡n cáº§n tÃ¬m má»™t tuyáº¿n Ä‘Æ°á»ng trong máº¡ng lÆ°á»›i cÃ³ Ä‘á»§ thanh khoáº£n. Náº¿u khÃ´ng Ä‘á»§, khoáº£ng thanh toÃ¡n sáº½ khÃ´ng Ä‘Æ°á»£c thá»±c hiá»‡n.

Xem xÃ©t vÃ­ dá»¥ máº¡ng lÆ°á»›i thanh khoáº£n nhÆ° sau:

```
Tráº¡ng thÃ¡i ban Ä‘áº§u cá»§a máº¡ng:
Alice (130 SAT) ==== (0 SAT) Susie (90 SAT) ==== (200 SAT) Eden (150 SAT) ==== (100 SAT) Bob
```
![cover](assets/Chapitre7/2.webp)

Náº¿u Alice muá»‘n chuyá»ƒn 40 SAT cho Bob, thÃ¬ thanh khoáº£n sáº½ Ä‘Æ°á»£c phÃ¢n phá»‘i láº¡i dá»c theo tuyáº¿n Ä‘Æ°á»ng giá»¯a hai ngÆ°á»i.

```
Sau khi Alice chuyá»ƒn 40 SAT cho Bob:
Alice (90 SAT) ==== (40 SAT) Susie (50 SAT) ==== (240 SAT) Eden (110 SAT) ==== (140 SAT) Bob
```
![cover](assets/Chapitre7/4.webp)

Tuy nhiÃªn, trong tráº¡ng thÃ¡i ban Ä‘áº§u, Bob khÃ´ng thá»ƒ gá»­i 40 SAT cho Alice vÃ¬ Susie khÃ´ng cÃ³ Ä‘á»§ thanh khoáº£n vá»›i Alice Ä‘á»ƒ gá»­i 40 SAT, vÃ¬ váº­y viá»‡c thanh toÃ¡n qua tuyáº¿n Ä‘Æ°á»ng nÃ y lÃ  khÃ´ng thá»ƒ. Do Ä‘Ã³, chÃºng ta cáº§n má»™t tuyáº¿n Ä‘Æ°á»ng khÃ¡c Ä‘á»ƒ giao dá»‹ch nÃ y trá»Ÿ nÃªn kháº£ thi.

Trong vÃ­ dá»¥ Ä‘áº§u tiÃªn, rÃµ rÃ ng lÃ  Susie vÃ  Eden khÃ´ng máº¥t gÃ¬ vÃ  cÅ©ng khÃ´ng Ä‘Æ°á»£c gÃ¬. CÃ¡c node cá»§a Lightning Network thu phÃ­ khi thanh khoáº£n cá»§a mÃ¬nh Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ chuyá»ƒn tiáº¿p giao dá»‹ch.

CÃ³ cÃ¡c loáº¡i phÃ­ khÃ¡c nhau tÃ¹y thuá»™c vÃ o nÆ¡i phÃ¢n bá»• cá»§a thanh khoáº£n.

Alice - Bob

- PhÃ­ cá»§a Alice = Alice -> Bob
- PhÃ­ cá»§a Bob = Bob -> Alice

![cover](assets/Chapitre7/5.webp)

CÃ³ hai loáº¡i phÃ­:

- má»™t má»©c phÃ­ cá»‘ Ä‘á»‹nh báº¥t ká»ƒ Ä‘á»™ lá»›n cá»§a khoáº£n thanh toÃ¡n: 1 SAT (máº·c Ä‘á»‹nh nhÆ°ng cÃ³ thá»ƒ Ä‘Æ°á»£c chá»‰nh sá»­a)
- má»™t má»©c phÃ­ thay Ä‘á»•i (theo máº·c Ä‘á»‹nh lÃ  1ppm - 1 pháº§n triá»‡u Ä‘á»™ lá»›n cá»§a khoáº£n thanh toÃ¡n)

VÃ­ dá»¥ vá» phÃ­:

- Alice - Susie; 1/1 (1 phÃ­ cá»‘ Ä‘á»‹nh vÃ  1 phÃ­ biáº¿n Ä‘á»•i)
- Susie - Eden; 0/200
- Eden - Bob; 1/1

Do Ä‘Ã³:

- PhÃ­ 1: (do Alice tráº£ cho chÃ­nh mÃ¬nh) 1 + (40.000\*0,000001)
- PhÃ­ 2: 0 + 40.000 \* 0,0002 = 8 SAT
- PhÃ­ 3: 1 + 40.000\* 0,000001 = 1,04 SAT

![cover](assets/Chapitre7/6.webp)

QuÃ¡ trÃ¬nh giao dá»‹ch:

1. Gá»­i 40.009,04 SAT tá»« Alice -> Susie; Alice tráº£ phi cho chÃ­nh mÃ¬nh nÃªn khÃ´ng tÃ­nh (PhÃ­ 1).
2. Susie gá»­i 40.001,04 SAT cho Eden; cÃ´ áº¥y láº¥y phÃ­ hoa há»“ng á»Ÿ má»©c 8 SAT (PhÃ­ 2).
3. Eden gá»­i 40.000 SAT cho Bob, anh ta láº¥y phÃ­ 1,04 SAT (PhÃ­ 3).

Alice Ä‘Ã£ tráº£ má»™t má»©c phÃ­ báº±ng 9,04 SAT vÃ  Bob nháº­n Ä‘Æ°á»£c 40.000 SAT.

![cover](assets/Chapitre7/7.webp)

Trong Lightning Network, node cá»§a Alice sáº½ quyáº¿t Ä‘á»‹nh tuyáº¿n Ä‘Æ°á»ng trÆ°á»›c khi gá»­i khoáº£n thanh toÃ¡n. Do Ä‘Ã³, Alice cáº§n pháº£i tÃ¬m kiáº¿m tuyáº¿n Ä‘Æ°á»ng tá»‘t nháº¥t vÃ  chá»‰ mÃ¬nh Alice biáº¿t vá» tuyáº¿n Ä‘Æ°á»ng Ä‘Ã³ vÃ  chi phÃ­. Khoáº£n thanh toÃ¡n Ä‘Æ°á»£c gá»­i Ä‘i, nhÆ°ng Susie khÃ´ng cÃ³ thÃ´ng tin gÃ¬ vá» nÃ³ cáº£.

![cover](assets/Chapitre7/9.webp)

Äá»‘i vá»›i Susie hoáº·c Eden: há» khÃ´ng biáº¿t ai lÃ  ngÆ°á»i nháº­n cuá»‘i cÃ¹ng, cÅ©ng khÃ´ng biáº¿t ai Ä‘ang gá»­i khoáº£n thanh toÃ¡n. ÄÃ¢y lÃ  cÆ¡ cháº¿ Ä‘á»‹nh tuyáº¿n onion  - onion routing. CÃ¡c node cáº§n pháº£i cÃ³ má»™t sÆ¡ Ä‘á»“ cá»§a máº¡ng lÆ°á»›i cÃ¡c ká»‡nh thanh toÃ¡n Ä‘á»ƒ tÃ¬m tuyáº¿n Ä‘Æ°á»ng phÃ¹ há»£p cho mÃ¬nh, nhÆ°ng Ä‘áº£m báº£o ráº±ng khÃ´ng cÃ³ báº¥t ká»³ trung gian nÃ o cÃ³ Ä‘Æ°á»£c thÃ´ng tin vá» giao dá»‹ch.

## HTLC - Há»£p Äá»“ng Thá»i Gian KhÃ³a BÄƒm
<chapterId>4369b85a-1365-55d8-99e1-509088210116</chapterId>

Trong má»™t há»‡ thá»‘ng Ä‘á»‹nh tuyáº¿n truyá»n thá»‘ng, lÃ m tháº¿ nÃ o chÃºng ta cÃ³ thá»ƒ Ä‘áº£m báº£o ráº±ng Eden khÃ´ng gian láº­n vÃ  tuÃ¢n thá»§ pháº§n cá»§a há»£p Ä‘á»“ng?

HTLC lÃ  má»™t há»£p Ä‘á»“ng thanh toÃ¡n chá»‰ cÃ³ thá»ƒ Ä‘Æ°á»£c má»Ÿ khÃ³a báº±ng má»™t bÃ­ máº­t. Náº¿u nÃ³ khÃ´ng Ä‘Æ°á»£c tiáº¿t lá»™, thÃ¬ há»£p Ä‘á»“ng sáº½ háº¿t háº¡n. Do Ä‘Ã³, Ä‘Ã¢y lÃ  má»™t thanh toÃ¡n cÃ³ Ä‘iá»u kiá»‡n. ChÃºng Ä‘Æ°á»£c sá»­ dá»¥ng nhÆ° tháº¿ nÃ o?

![instruction](assets/chapitre8/0.webp)

Xem xÃ©t tÃ¬nh huá»‘ng sau:
Alice (100,000 SAT) ==== (30,000 SAT) Susie (250,000 SAT) ==== (0 SAT) Bob
- Bob táº¡o ra má»™t bÃ­ máº­t S (hÃ¬nh áº£nh trÆ°á»›c) vÃ  tÃ­nh toÃ¡n bÄƒm r = hash(s)
- Bob gá»­i má»™t hÃ³a Ä‘Æ¡n cho Alice vá»›i "r" Ä‘Æ°á»£c bao gá»“m
- Alice gá»­i má»™t HTLC cá»§a 40,000 SAT cho Susie vá»›i Ä‘iá»u kiá»‡n tiáº¿t lá»™ "s'" sao cho hash(s') = r
- Susie gá»­i má»™t HTLC tÆ°Æ¡ng tá»± cho Bob
- Bob má»Ÿ khÃ³a HTLC cá»§a Susie báº±ng cÃ¡ch cho cÃ´ áº¥y xem "s"
- Susie má»Ÿ khÃ³a HTLC cá»§a Alice báº±ng cÃ¡ch cho cÃ´ áº¥y xem "S"

Náº¿u Bob khÃ´ng trá»±c tuyáº¿n vÃ  khÃ´ng bao giá» láº¥y Ä‘Æ°á»£c bÃ­ máº­t cho phÃ©p anh ta nháº­n tiá»n, thÃ¬ HTLC sáº½ háº¿t háº¡n sau má»™t sá»‘ lÆ°á»£ng khá»‘i nháº¥t Ä‘á»‹nh.

![instruction](assets/chapitre8/1.webp)

CÃ¡c HTLC háº¿t háº¡n theo thá»© tá»± ngÆ°á»£c láº¡i: háº¿t háº¡n Susie-Bob, sau Ä‘Ã³ lÃ  háº¿t háº¡n Alice-Susie. NhÆ° váº­y, náº¿u Bob trá»Ÿ láº¡i, nÃ³ khÃ´ng thay Ä‘á»•i gÃ¬. NgÆ°á»£c láº¡i, náº¿u Alice há»§y bá» trong khi Bob trá»Ÿ láº¡i, nÃ³ sáº½ lÃ  má»™t má»› há»—n Ä‘á»™n vÃ  má»i ngÆ°á»i cÃ³ thá»ƒ Ä‘Ã£ lÃ m viá»‡c vÃ´ Ã­ch.

Váº­y, Ä‘iá»u gÃ¬ xáº£y ra trong trÆ°á»ng há»£p Ä‘Ã³ng cá»­a? Thá»±c táº¿, cÃ¡c giao dá»‹ch cam káº¿t cá»§a chÃºng tÃ´i cÃ²n phá»©c táº¡p hÆ¡n ná»¯a. ChÃºng ta cáº§n Ä‘áº¡i diá»‡n cho sá»‘ dÆ° trung gian náº¿u kÃªnh Ä‘Æ°á»£c Ä‘Ã³ng láº¡i.

Do Ä‘Ã³, cÃ³ má»™t HTLC-out cá»§a 40,000 satoshi (vá»›i cÃ¡c háº¡n cháº¿ Ä‘Ã£ tháº¥y trÆ°á»›c Ä‘Ã³) trong giao dá»‹ch cam káº¿t qua output #3.

![instruction](assets/chapitre8/2.webp)

Alice cÃ³ trong giao dá»‹ch cam káº¿t:

- Output #1: 60,000 SAT cho Alice qua má»™t Timelock vÃ  khÃ³a thu há»“i (sá»‘ tiá»n cÃ²n láº¡i cho cÃ´ áº¥y)
- Output #2: 30,000 Ä‘Ã£ thuá»™c vá» Susie
- Output #3: 40,000 trong HTLC

Giao dá»‹ch cam káº¿t cá»§a Alice cÃ³ HTLC-out vÃ¬ cÃ´ áº¥y gá»­i má»™t HTLC-in cho ngÆ°á»i nháº­n, Susie.

![instruction](assets/chapitre8/3.webp)

Do Ä‘Ã³, náº¿u chÃºng ta cÃ´ng bá»‘ giao dá»‹ch cam káº¿t nÃ y, Susie cÃ³ thá»ƒ láº¥y tiá»n HTCL vá»›i hÃ¬nh áº£nh "s". Náº¿u cÃ´ áº¥y khÃ´ng cÃ³ hÃ¬nh áº£nh trÆ°á»›c, Alice láº¥y láº¡i tiá»n sau khi HTCL háº¿t háº¡n. HÃ£y nghÄ© vá» cÃ¡c output (UTXO) nhÆ° lÃ  cÃ¡c khoáº£n thanh toÃ¡n khÃ¡c nhau vá»›i cÃ¡c Ä‘iá»u kiá»‡n khÃ¡c nhau.
Má»™t khi thanh toÃ¡n Ä‘Æ°á»£c thá»±c hiá»‡n (háº¿t háº¡n hoáº·c thá»±c thi), tráº¡ng thÃ¡i kÃªnh thay Ä‘á»•i vÃ  giao dá»‹ch vá»›i HTCL khÃ´ng cÃ²n tá»“n táº¡i ná»¯a. ChÃºng ta quay trá»Ÿ láº¡i vá»›i Ä‘iá»u gÃ¬ Ä‘Ã³ cá»• Ä‘iá»ƒn.
Trong trÆ°á»ng há»£p Ä‘Ã³ng cá»­a há»£p tÃ¡c: chÃºng ta dá»«ng thanh toÃ¡n vÃ  do Ä‘Ã³ chá» Ä‘á»£i thá»±c thi chuyá»ƒn giao/HTCL, giao dá»‹ch nháº¹ hÆ¡n nÃªn Ã­t tá»‘n kÃ©m hÆ¡n vÃ¬ cÃ³ tá»‘i Ä‘a 1 hoáº·c 2 output.
Náº¿u Ä‘Ã³ng cá»­a báº¯t buá»™c: chÃºng ta cÃ´ng bá»‘ vá»›i táº¥t cáº£ cÃ¡c HTLC Ä‘ang tiáº¿n hÃ nh, vÃ¬ váº­y nÃ³ trá»Ÿ nÃªn ráº¥t náº·ng vÃ  ráº¥t tá»‘n kÃ©m. VÃ  Ä‘Ã³ lÃ  má»™t má»› há»—n Ä‘á»™n.

TÃ³m láº¡i, há»‡ thá»‘ng Ä‘á»‹nh tuyáº¿n Máº¡ng LÆ°á»›i SÃ©t sá»­ dá»¥ng Há»£p Äá»“ng Bá»‹ KhÃ³a Báº±ng Thá»i Gian Hash (HTLC) Ä‘á»ƒ Ä‘áº£m báº£o thanh toÃ¡n an toÃ n vÃ  cÃ³ thá»ƒ xÃ¡c minh. HTLC cho phÃ©p thanh toÃ¡n cÃ³ Ä‘iá»u kiá»‡n nÆ¡i tiá»n chá»‰ cÃ³ thá»ƒ Ä‘Æ°á»£c má»Ÿ khÃ³a báº±ng má»™t bÃ­ máº­t, do Ä‘Ã³ Ä‘áº£m báº£o ráº±ng cÃ¡c bÃªn tham gia thá»±c hiá»‡n cam káº¿t cá»§a há».
Trong vÃ­ dá»¥ Ä‘Æ°á»£c trÃ¬nh bÃ y, Alice muá»‘n gá»­i SAT cho Bob thÃ´ng qua Susie. Bob táº¡o ra má»™t bÃ­ máº­t, táº¡o ra má»™t bÄƒm cá»§a nÃ³ vÃ  truyá»n nÃ³ cho Alice. Alice vÃ  Susie thiáº¿t láº­p má»™t HTLC dá»±a trÃªn bÄƒm nÃ y. Má»™t khi Bob má»Ÿ khÃ³a HTLC cá»§a Susie báº±ng cÃ¡ch cho cÃ´ áº¥y xem bÃ­ máº­t, Susie cÃ³ thá»ƒ sau Ä‘Ã³ má»Ÿ khÃ³a HTLC cá»§a Alice.
Trong trÆ°á»ng há»£p Bob khÃ´ng tiáº¿t lá»™ bÃ­ máº­t trong má»™t khoáº£ng thá»i gian nháº¥t Ä‘á»‹nh, HTLC sáº½ háº¿t háº¡n. Háº¿t háº¡n xáº£y ra theo thá»© tá»± ngÆ°á»£c láº¡i, Ä‘áº£m báº£o ráº±ng náº¿u Bob trá»Ÿ láº¡i trá»±c tuyáº¿n, khÃ´ng cÃ³ háº­u quáº£ khÃ´ng mong muá»‘n nÃ o.
Khi Ä‘Ã³ng kÃªnh, náº¿u Ä‘Ã³ lÃ  má»™t viá»‡c Ä‘Ã³ng cá»­a há»£p tÃ¡c, cÃ¡c khoáº£n thanh toÃ¡n bá»‹ giÃ¡n Ä‘oáº¡n vÃ  HTLCs Ä‘Æ°á»£c giáº£i quyáº¿t, Ä‘iá»u nÃ y thÆ°á»ng Ã­t tá»‘n kÃ©m hÆ¡n. Náº¿u viá»‡c Ä‘Ã³ng cá»­a bá»‹ Ã©p buá»™c, táº¥t cáº£ cÃ¡c giao dá»‹ch HTLC Ä‘ang diá»…n ra Ä‘Æ°á»£c cÃ´ng bá»‘, cÃ³ thá»ƒ trá»Ÿ nÃªn ráº¥t tá»‘n kÃ©m vÃ  rá»‘i ráº¯m. TÃ³m láº¡i, cÆ¡ cháº¿ HTLC thÃªm má»™t lá»›p báº£o máº­t bá»• sung cho Lightning Network, Ä‘áº£m báº£o ráº±ng cÃ¡c khoáº£n thanh toÃ¡n Ä‘Æ°á»£c thá»±c hiá»‡n chÃ­nh xÃ¡c vÃ  ngÆ°á»i dÃ¹ng thá»±c hiá»‡n cÃ¡c cam káº¿t cá»§a há».

## TÃ¬m Ä‘Æ°á»ng Ä‘i
<chapterId>7e2ae959-c2a1-512e-b5d6-8fd962e819da</chapterId>

Dá»¯ liá»‡u cÃ´ng khai duy nháº¥t lÃ  tá»•ng dung lÆ°á»£ng kÃªnh (Alice + Bob) nhÆ°ng chÃºng ta khÃ´ng biáº¿t vá»‹ trÃ­ cá»§a tÃ­nh thanh khoáº£n.
Äá»ƒ cÃ³ thÃªm thÃ´ng tin, nÃºt cá»§a chÃºng ta láº¯ng nghe kÃªnh truyá»n thÃ´ng LN Ä‘á»ƒ nháº­n thÃ´ng bÃ¡o vá» cÃ¡c kÃªnh má»›i vÃ  cáº­p nháº­t phÃ­ kÃªnh. NÃºt cá»§a báº¡n cÅ©ng xem xÃ©t blockchain Ä‘á»ƒ tÃ¬m cÃ¡c Ä‘Ã³ng cá»­a kÃªnh.

VÃ¬ chÃºng ta khÃ´ng cÃ³ táº¥t cáº£ thÃ´ng tin, chÃºng ta pháº£i tÃ¬m má»™t Ä‘á»“ thá»‹/Ä‘Æ°á»ng Ä‘i vá»›i thÃ´ng tin chÃºng ta cÃ³ (dung lÆ°á»£ng kÃªnh tá»‘i Ä‘a vÃ  khÃ´ng pháº£i vá»‹ trÃ­ cá»§a tÃ­nh thanh khoáº£n).

TiÃªu chÃ­:

- Kháº£ nÄƒng thÃ nh cÃ´ng - PhÃ­
- Thá»i gian háº¿t háº¡n HTLC
- Sá»‘ lÆ°á»£ng nÃºt trung gian
- Ngáº«u nhiÃªn

![graph](assets/chapitre9/1.webp)

VÃ¬ váº­y, náº¿u cÃ³ 3 Ä‘Æ°á»ng Ä‘i cÃ³ thá»ƒ:

- Alice > 1 > 2 > 5 > Bob
- Alice > 1 > 2 > 4 > 5 > Bob
- Alice 1 > 2 > 3 > Bob

ChÃºng ta Ä‘ang tÃ¬m Ä‘Æ°á»ng Ä‘i tá»‘t nháº¥t theo lÃ½ thuyáº¿t vá»›i phÃ­ tháº¥p nháº¥t vÃ  kháº£ nÄƒng thÃ nh cÃ´ng cao nháº¥t: tÃ­nh thanh khoáº£n tá»‘i Ä‘a vÃ  Ã­t bÆ°á»›c nháº¥t cÃ³ thá»ƒ.

VÃ­ dá»¥, náº¿u 2-3 chá»‰ cÃ³ dung lÆ°á»£ng 130,000 SAT, viá»‡c gá»­i 100,000 lÃ  ráº¥t khÃ³ khÄƒn, vÃ¬ váº­y lá»±a chá»n #3 khÃ´ng cÃ³ cÆ¡ há»™i thÃ nh cÃ´ng.

![graph](assets/chapitre9/2.webp)

BÃ¢y giá» thuáº­t toÃ¡n Ä‘Ã£ Ä‘Æ°a ra 3 lá»±a chá»n cá»§a mÃ¬nh vÃ  sáº½ thá»­ lá»±a chá»n Ä‘áº§u tiÃªn:

Lá»±a chá»n 1:

- Alice gá»­i má»™t HTLC 100,000 SAT cho 1;
- 1 táº¡o má»™t HTLC 100,000 SAT cho 2;
- 2 táº¡o má»™t HTLC 100,000 SAT cho 5, nhÆ°ng 5 khÃ´ng thá»ƒ thá»±c hiá»‡n, vÃ¬ váº­y nÃ³ thÃ´ng bÃ¡o.

ThÃ´ng tin Ä‘Æ°á»£c gá»­i trá»Ÿ láº¡i, vÃ¬ váº­y Alice quyáº¿t Ä‘á»‹nh thá»­ Ä‘Æ°á»ng Ä‘i thá»© hai:

- Alice gá»­i má»™t HTLC 100,000 cho 1;
- 1 táº¡o má»™t HTLC 100,000 cho 2;
- 2 táº¡o má»™t HTLC 100,000 cho 4;
- 4 táº¡o má»™t HTLC 100,000 cho Bob. Bob cÃ³ tÃ­nh thanh khoáº£n, vÃ¬ váº­y má»i thá»© á»•n.
- Bob sá»­ dá»¥ng preimage (hash) cá»§a HTLC vÃ  do Ä‘Ã³ sá»­ dá»¥ng bÃ­ máº­t Ä‘á»ƒ láº¥y láº¡i 100,000 SAT
- 5 giá» Ä‘Ã¢y cÃ³ bÃ­ máº­t cá»§a HTLC Ä‘á»ƒ láº¥y láº¡i HTLC bá»‹ cháº·n tá»« 4
- 4 giá» Ä‘Ã¢y cÃ³ bÃ­ máº­t cá»§a HTLC Ä‘á»ƒ láº¥y láº¡i HTLC bá»‹ cháº·n tá»« 2
- 2 giá» Ä‘Ã¢y cÃ³ bÃ­ máº­t cá»§a HTLC Ä‘á»ƒ láº¥y láº¡i HTLC bá»‹ cháº·n tá»« 1
- 1 giá» Ä‘Ã¢y cÃ³ bÃ­ máº­t cá»§a HTLC Ä‘á»ƒ láº¥y láº¡i HTLC bá»‹ cháº·n cá»§a Alice

Alice khÃ´ng tháº¥y sá»± tháº¥t báº¡i cá»§a Ä‘Æ°á»ng Ä‘i 1, cÃ´ chá»‰ chá» thÃªm má»™t giÃ¢y ná»¯a. Má»™t sá»± tháº¥t báº¡i thanh toÃ¡n xáº£y ra khi khÃ´ng cÃ³ Ä‘Æ°á»ng Ä‘i nÃ o kháº£ thi. Äá»ƒ tÃ¬m kiáº¿m má»™t Ä‘Æ°á»ng Ä‘i dá»… dÃ ng hÆ¡n, Bob cÃ³ thá»ƒ cung cáº¥p thÃ´ng tin cho Alice Ä‘á»ƒ giÃºp vá»›i hÃ³a Ä‘Æ¡n cá»§a mÃ¬nh:

- Sá»‘ tiá»n
- Äá»‹a chá»‰ cá»§a anh áº¥y
- Hash cá»§a preimage Ä‘á»ƒ Alice cÃ³ thá»ƒ táº¡o HTLC
- Chá»‰ dáº«n vá» cÃ¡c kÃªnh cá»§a Bob
Bob biáº¿t vá» tÃ­nh thanh khoáº£n cá»§a cÃ¡c kÃªnh 5 vÃ  3 vÃ¬ anh áº¥y trá»±c tiáº¿p káº¿t ná»‘i vá»›i chÃºng, anh áº¥y cÃ³ thá»ƒ chá»‰ ra Ä‘iá»u nÃ y cho Alice. Anh áº¥y cáº£nh bÃ¡o Alice ráº±ng nÃºt 3 lÃ  vÃ´ dá»¥ng, Ä‘iá»u nÃ y ngÄƒn Alice tiá»m nÄƒng táº¡o ra lá»™ trÃ¬nh cá»§a mÃ¬nh. Má»™t yáº¿u tá»‘ khÃ¡c cÃ³ thá»ƒ lÃ  cÃ¡c kÃªnh riÃªng tÆ° (do Ä‘Ã³ khÃ´ng Ä‘Æ°á»£c cÃ´ng bá»‘ trÃªn máº¡ng) mÃ  Bob cÃ³ thá»ƒ cÃ³. Náº¿u Bob cÃ³ má»™t kÃªnh riÃªng vá»›i 1, anh áº¥y cÃ³ thá»ƒ nÃ³i vá»›i Alice sá»­ dá»¥ng nÃ³ vÃ  nÃ³ sáº½ cho Alice > 1 > Bob'.

![graph](assets/chapitre9/3.webp)

Káº¿t luáº­n, viá»‡c Ä‘á»‹nh tuyáº¿n giao dá»‹ch trÃªn Lightning Network lÃ  má»™t quÃ¡ trÃ¬nh phá»©c táº¡p Ä‘Ã²i há»i pháº£i xem xÃ©t cÃ¡c yáº¿u tá»‘ khÃ¡c nhau. Máº·c dÃ¹ tá»•ng dung lÆ°á»£ng cá»§a cÃ¡c kÃªnh lÃ  cÃ´ng khai, nhÆ°ng phÃ¢n bá»• chÃ­nh xÃ¡c cá»§a tÃ­nh thanh khoáº£n khÃ´ng trá»±c tiáº¿p truy cáº­p Ä‘Æ°á»£c. Äiá»u nÃ y buá»™c cÃ¡c nÃºt pháº£i Æ°á»›c lÆ°á»£ng cÃ¡c lá»™ trÃ¬nh thÃ nh cÃ´ng nháº¥t cÃ³ thá»ƒ, lÆ°u Ã½ Ä‘áº¿n cÃ¡c tiÃªu chÃ­ nhÆ° phÃ­, thá»i gian háº¿t háº¡n HTLC, sá»‘ lÆ°á»£ng nÃºt trung gian, vÃ  yáº¿u tá»‘ ngáº«u nhiÃªn. Khi cÃ³ nhiá»u lá»™ trÃ¬nh cÃ³ thá»ƒ, cÃ¡c nÃºt tÃ¬m cÃ¡ch giáº£m thiá»ƒu phÃ­ vÃ  tá»‘i Ä‘a hÃ³a cÆ¡ há»™i thÃ nh cÃ´ng báº±ng cÃ¡ch chá»n cÃ¡c kÃªnh cÃ³ Ä‘á»§ tÃ­nh thanh khoáº£n vÃ  sá»‘ bÆ°á»›c nháº£y tá»‘i thiá»ƒu. Náº¿u má»™t ná»— lá»±c giao dá»‹ch tháº¥t báº¡i do thiáº¿u tÃ­nh thanh khoáº£n, má»™t lá»™ trÃ¬nh khÃ¡c Ä‘Æ°á»£c thá»­ cho Ä‘áº¿n khi má»™t giao dá»‹ch thÃ nh cÃ´ng Ä‘Æ°á»£c thá»±c hiá»‡n.

HÆ¡n ná»¯a, Ä‘á»ƒ táº¡o Ä‘iá»u kiá»‡n tÃ¬m kiáº¿m lá»™ trÃ¬nh, ngÆ°á»i nháº­n cÃ³ thá»ƒ cung cáº¥p thÃ´ng tin bá»• sung nhÆ° Ä‘á»‹a chá»‰, sá»‘ tiá»n, bÄƒm preimage, vÃ  chá»‰ dáº«n vá» cÃ¡c kÃªnh cá»§a há». Äiá»u nÃ y cÃ³ thá»ƒ giÃºp xÃ¡c Ä‘á»‹nh cÃ¡c kÃªnh cÃ³ Ä‘á»§ tÃ­nh thanh khoáº£n vÃ  trÃ¡nh cÃ¡c ná»— lá»±c giao dá»‹ch khÃ´ng cáº§n thiáº¿t. Cuá»‘i cÃ¹ng, há»‡ thá»‘ng Ä‘á»‹nh tuyáº¿n cá»§a Lightning Network Ä‘Æ°á»£c thiáº¿t káº¿ Ä‘á»ƒ tá»‘i Æ°u hÃ³a tá»‘c Ä‘á»™, an ninh, vÃ  hiá»‡u quáº£ cá»§a giao dá»‹ch trong khi báº£o vá»‡ quyá»n riÃªng tÆ° cá»§a ngÆ°á»i dÃ¹ng.

# CÃ´ng Cá»¥ cá»§a Lightning Network
<partId>74d6c334-ec5d-55d9-8598-f05694703bf6</partId>

## HÃ³a ÄÆ¡n, LNURL, Keysend
<chapterId>e34c7ecd-2327-52e3-b61e-c837d9e5e8b0</chapterId>

![cover](assets/chapitre10/0.webp)

Má»™t hÃ³a Ä‘Æ¡n LN (hoáº·c hÃ³a Ä‘Æ¡n) dÃ i vÃ  khÃ´ng dá»… Ä‘á»c, nhÆ°ng nÃ³ cho phÃ©p biá»ƒu diá»…n dÃ y Ä‘áº·c cá»§a má»™t yÃªu cáº§u thanh toÃ¡n.

VÃ­ dá»¥:
lnbc1m1pskuawzpp5qeuuva2txazy5g483tuv9pznn9ft8l5e49s5dndj2pqq0ptyn8msdqqcqzpgxqrrsssp5v4s00u579atm0em6eqm9nr7d0vr64z5j2sm5s33x3r9m4lgfdueq9qyyssqxkjzzgx5ef7ez3dks0laxayx4grrw7j22ppgzyhpydtv6hmc39skf9hjxn5yd3kvv7zpjdxd2s7crcnemh2fz26mnr6zu83w0a2fwxcqnvujl3

- lnbc1m = pháº§n cÃ³ thá»ƒ Ä‘á»c Ä‘Æ°á»£c
- 1 = phÃ¢n cÃ¡ch vá»›i pháº§n cÃ²n láº¡i
- Sau Ä‘Ã³ lÃ  pháº§n cÃ²n láº¡i
- Bc1 = mÃ£ hÃ³a Bech32 (base 32), vÃ¬ váº­y sá»­ dá»¥ng 32 kÃ½ tá»±.
- 10 = 1.2.3.4.5.6.7.8.9.0
- 26 = abcdefghijklmnopqrstuvwxyz
- 32 = khÃ´ng bao gá»“m "b-i-o" vÃ  khÃ´ng "1"

### lnbc1m

- ln = Lightning
- Bc = bitcoin (mainnet)
- 1 = sá»‘ lÆ°á»£ng
- M = milli (10^-3 / u = micro 10^-6 / n = nano 10^-9 / p = pico 10^-12'
  á» Ä‘Ã¢y 1m = 1 * 0.0001btc = 100,000 BTC
Vui lÃ²ng thanh toÃ¡n 100,000 SAT trÃªn máº¡ng Lightning cá»§a Bitcoin mainnet cho pskuawzpp5qeuuva2txazy5g483tuv9pznn9ft8l5e49s5dndj2pqq0ptyn8msdqqcqzpgxqrrsssp5v4s00u579atm0em6eqm9nr7d0vr64z5j2sm5s33x3r9m4lgfdueq9qyyssqxkjzzgx5ef7ez3dks0laxayx4grrw7j22ppgzyhpydtv6hmc39skf9hjxn5yd3kvv7zpjdxd2s7crcnemh2fz26mnr6zu83w0a2fwxcqnvujl3
### Dáº¥u thá»i gian (khi Ä‘Æ°á»£c táº¡o)

NÃ³ chá»©a 0 hoáº·c nhiá»u pháº§n bá»• sung:

- Hash cá»§a preimage
- BÃ­ máº­t thanh toÃ¡n (onion routing)
- Dá»¯ liá»‡u tÃ¹y Ã½
- KhÃ³a cÃ´ng khai LN cá»§a ngÆ°á»i nháº­n
- Thá»i gian háº¿t háº¡n (máº·c Ä‘á»‹nh 1 giá»)
- Gá»£i Ã½ Ä‘á»‹nh tuyáº¿n
- Chá»¯ kÃ½ cá»§a toÃ n bá»™

CÃ³ cÃ¡c loáº¡i hÃ³a Ä‘Æ¡n khÃ¡c. Giao thá»©c meta LNURL cho phÃ©p cung cáº¥p má»™t lÆ°á»£ng satoshi cá»¥ thá»ƒ thay vÃ¬ táº¡o má»™t yÃªu cáº§u. Äiá»u nÃ y ráº¥t linh hoáº¡t vÃ  cho phÃ©p nhiá»u cáº£i tiáº¿n vá» tráº£i nghiá»‡m ngÆ°á»i dÃ¹ng.

![cover](assets/chapitre10/2.webp)

Keysend cho phÃ©p Alice gá»­i tiá»n cho Bob mÃ  khÃ´ng cáº§n yÃªu cáº§u cá»§a Bob. Alice láº¥y ID cá»§a Bob, táº¡o má»™t preimage mÃ  khÃ´ng há»i Bob, vÃ  bao gá»“m nÃ³ trong thanh toÃ¡n cá»§a mÃ¬nh. VÃ¬ váº­y, Bob sáº½ nháº­n Ä‘Æ°á»£c má»™t yÃªu cáº§u báº¥t ngá» nÆ¡i anh cÃ³ thá»ƒ má»Ÿ khÃ³a tiá»n vÃ¬ Alice Ä‘Ã£ thá»±c hiá»‡n cÃ´ng viá»‡c.

![cover](assets/chapitre10/3.webp)

Káº¿t luáº­n, má»™t hÃ³a Ä‘Æ¡n máº¡ng Lightning, máº·c dÃ¹ phá»©c táº¡p á»Ÿ cÃ¡i nhÃ¬n Ä‘áº§u tiÃªn, hiá»‡u quáº£ mÃ£ hÃ³a má»™t yÃªu cáº§u thanh toÃ¡n. Má»—i pháº§n cá»§a hÃ³a Ä‘Æ¡n chá»©a thÃ´ng tin quan trá»ng, bao gá»“m sá»‘ tiá»n pháº£i tráº£, ngÆ°á»i nháº­n, dáº¥u thá»i gian táº¡o, vÃ  cÃ³ thá»ƒ lÃ  thÃ´ng tin khÃ¡c nhÆ° hash cá»§a preimage, bÃ­ máº­t thanh toÃ¡n, gá»£i Ã½ Ä‘á»‹nh tuyáº¿n, vÃ  thá»i gian háº¿t háº¡n. CÃ¡c giao thá»©c nhÆ° LNURL vÃ  Keysend cung cáº¥p nhá»¯ng cáº£i tiáº¿n Ä‘Ã¡ng ká»ƒ vá» linh hoáº¡t vÃ  tráº£i nghiá»‡m ngÆ°á»i dÃ¹ng, cho phÃ©p, vÃ­ dá»¥, gá»­i tiá»n mÃ  khÃ´ng cáº§n yÃªu cáº§u trÆ°á»›c tá»« bÃªn kia. Nhá»¯ng cÃ´ng nghá»‡ nÃ y lÃ m cho quÃ¡ trÃ¬nh thanh toÃ¡n trá»Ÿ nÃªn mÆ°á»£t mÃ  vÃ  hiá»‡u quáº£ hÆ¡n trÃªn máº¡ng Lightning.

## Quáº£n lÃ½ TÃ­nh thanh khoáº£n
<chapterId>cc76d0c4-d958-57f5-84bf-177e21393f48</chapterId>

![instruction](assets/chapitre11/0.webp)

ChÃºng tÃ´i cung cáº¥p má»™t sá»‘ hÆ°á»›ng dáº«n chung Ä‘á»ƒ tráº£ lá»i cÃ¢u há»i muÃ´n thuá»Ÿ vá» viá»‡c quáº£n lÃ½ tÃ­nh thanh khoáº£n trÃªn Lightning.

Trong LN, cÃ³ 3 loáº¡i ngÆ°á»i:

- NgÆ°á»i mua: há» cÃ³ tÃ­nh thanh khoáº£n Ä‘i ra, Ä‘Ã¢y lÃ  Ä‘iá»u Ä‘Æ¡n giáº£n nháº¥t vÃ¬ há» chá»‰ cáº§n má»Ÿ kÃªnh
- CÃ¡c nhÃ  bÃ¡n láº»: phá»©c táº¡p hÆ¡n vÃ¬ há» cáº§n tÃ­nh thanh khoáº£n Ä‘áº¿n tá»« cÃ¡c nÃºt khÃ¡c vÃ  cÃ¡c nhÃ¢n váº­t khÃ¡c. Há» pháº£i cÃ³ ngÆ°á»i káº¿t ná»‘i vá»›i há»
- CÃ¡c nÃºt Ä‘á»‹nh tuyáº¿n: há» muá»‘n cÃ¢n báº±ng tÃ­nh thanh khoáº£n á»Ÿ cáº£ hai bÃªn vÃ  cÃ³ káº¿t ná»‘i tá»‘t vá»›i nhiá»u nÃºt Ä‘á»ƒ Ä‘Æ°á»£c sá»­ dá»¥ng cÃ ng nhiá»u cÃ ng tá»‘t

VÃ¬ váº­y, náº¿u báº¡n cáº§n tÃ­nh thanh khoáº£n Ä‘áº¿n, báº¡n cÃ³ thá»ƒ mua nÃ³ tá»« cÃ¡c dá»‹ch vá»¥.

![instruction](assets/chapitre11/1.webp)

Alice mua má»™t kÃªnh vá»›i Susie vá»›i 1 triá»‡u satoshis, vÃ¬ váº­y cÃ´ áº¥y má»Ÿ má»™t kÃªnh vá»›i trá»±c tiáº¿p 1,000,000 SAT á»Ÿ phÃ­a Ä‘áº¿n. CÃ´ áº¥y sau Ä‘Ã³ cÃ³ thá»ƒ cháº¥p nháº­n thanh toÃ¡n lÃªn Ä‘áº¿n 1 triá»‡u SAT tá»« khÃ¡ch hÃ ng Ä‘Æ°á»£c káº¿t ná»‘i vá»›i Susie (ngÆ°á»i cÃ³ nhiá»u káº¿t ná»‘i).

Má»™t giáº£i phÃ¡p khÃ¡c sáº½ lÃ  thá»±c hiá»‡n thanh toÃ¡n; báº¡n tráº£ 100,000 cho lÃ½ do X, báº¡n giá» Ä‘Ã¢y cÃ³ thá»ƒ nháº­n 100,000.

![instruction](assets/chapitre11/2.webp)
### Giáº£i phÃ¡p Loop Out: HoÃ¡n Ä‘á»•i nguyÃªn tá»­ LN - BTC
Alice 2 triá»‡u - Susie 0

![instruction](assets/chapitre11/3.webp)

Alice muá»‘n gá»­i thanh khoáº£n cho Susie, vÃ¬ váº­y cÃ´ áº¥y thá»±c hiá»‡n má»™t Loop out (má»™t node Ä‘áº·c biá»‡t cung cáº¥p dá»‹ch vá»¥ chuyÃªn nghiá»‡p Ä‘á»ƒ cÃ¢n báº±ng láº¡i LN/BTC).
Alice gá»­i 1 triá»‡u cho Loop qua node cá»§a Susie, vÃ¬ váº­y Susie cÃ³ thanh khoáº£n vÃ  Loop gá»­i láº¡i sá»‘ dÆ° on-chain cho node cá»§a Alice.

![instruction](assets/chapitre11/4.webp)

VÃ¬ váº­y, 1 triá»‡u Ä‘i Ä‘áº¿n Susie, Susie gá»­i 1 triá»‡u cho Loop, Loop gá»­i 1 triá»‡u cho Alice. NhÆ° váº­y, Alice Ä‘Ã£ chuyá»ƒn thanh khoáº£n cho Susie vá»›i chi phÃ­ lÃ  má»™t sá»‘ phÃ­ tráº£ cho Loop cho dá»‹ch vá»¥ nÃ y.

Äiá»u phá»©c táº¡p nháº¥t trong LN lÃ  giá»¯ thanh khoáº£n.

![instruction](assets/chapitre11/5.webp)

Káº¿t luáº­n, quáº£n lÃ½ thanh khoáº£n trÃªn Lightning Network lÃ  má»™t váº¥n Ä‘á» chÃ­nh phá»¥ thuá»™c vÃ o loáº¡i ngÆ°á»i dÃ¹ng: ngÆ°á»i mua, ngÆ°á»i bÃ¡n, hoáº·c node Ä‘á»‹nh tuyáº¿n. NgÆ°á»i mua, cáº§n thanh khoáº£n ra, cÃ³ nhiá»‡m vá»¥ Ä‘Æ¡n giáº£n nháº¥t: há» chá»‰ cáº§n má»Ÿ kÃªnh. NgÆ°á»i bÃ¡n, cáº§n thanh khoáº£n vÃ o, pháº£i Ä‘Æ°á»£c káº¿t ná»‘i vá»›i cÃ¡c node vÃ  cÃ¡c nhÃ¢n váº­t khÃ¡c. NgÆ°á»£c láº¡i, cÃ¡c node Ä‘á»‹nh tuyáº¿n tÃ¬m cÃ¡ch duy trÃ¬ sá»± cÃ¢n báº±ng thanh khoáº£n á»Ÿ cáº£ hai phÃ­a. CÃ³ má»™t sá»‘ giáº£i phÃ¡p tá»“n táº¡i Ä‘á»ƒ quáº£n lÃ½ thanh khoáº£n, nhÆ° mua kÃªnh hoáº·c tráº£ tiá»n Ä‘á»ƒ tÄƒng kháº£ nÄƒng nháº­n. TÃ¹y chá»n "Loop Out", cho phÃ©p HoÃ¡n Ä‘á»•i nguyÃªn tá»­ giá»¯a LN vÃ  BTC, cung cáº¥p má»™t giáº£i phÃ¡p thÃº vá»‹ cho viá»‡c cÃ¢n báº±ng láº¡i thanh khoáº£n. Máº·c dÃ¹ cÃ³ nhá»¯ng chiáº¿n lÆ°á»£c nÃ y, viá»‡c duy trÃ¬ thanh khoáº£n trÃªn Lightning Network váº«n lÃ  má»™t thÃ¡ch thá»©c phá»©c táº¡p.

# Äi sÃ¢u hÆ¡n
<partId>6bbf107d-a224-5916-9f0c-2b4d30dd0b17</partId>

## TÃ³m táº¯t khÃ³a há»c
<chapterId>a65a571c-561b-5e1c-87bf-494644653c22</chapterId>

Má»¥c tiÃªu cá»§a chÃºng tÃ´i lÃ  giáº£i thÃ­ch cÃ¡ch Lightning Network hoáº¡t Ä‘á»™ng vÃ  nÃ³ phá»¥ thuá»™c vÃ o Bitcoin nhÆ° tháº¿ nÃ o Ä‘á»ƒ hoáº¡t Ä‘á»™ng.

Lightning Network lÃ  má»™t máº¡ng lÆ°á»›i cÃ¡c kÃªnh thanh toÃ¡n. ChÃºng tÃ´i Ä‘Ã£ xem xÃ©t cÃ¡ch má»™t kÃªnh thanh toÃ¡n hoáº¡t Ä‘á»™ng giá»¯a hai bÃªn liÃªn quan, nhÆ°ng chÃºng tÃ´i cÅ©ng Ä‘Ã£ má»Ÿ rá»™ng táº§m nhÃ¬n cá»§a mÃ¬nh ra toÃ n bá»™ máº¡ng lÆ°á»›i, Ä‘áº¿n khÃ¡i niá»‡m vá» má»™t máº¡ng lÆ°á»›i cÃ¡c kÃªnh thanh toÃ¡n.

![instruction](assets/chapitre12/0.webp)

CÃ¡c kÃªnh Ä‘Æ°á»£c má»Ÿ thÃ´ng qua má»™t giao dá»‹ch Bitcoin vÃ  cÃ³ thá»ƒ chá»©a nhiá»u giao dá»‹ch nháº¥t cÃ³ thá»ƒ. Tráº¡ng thÃ¡i cá»§a kÃªnh Ä‘Æ°á»£c biá»ƒu diá»…n bá»Ÿi má»™t giao dá»‹ch cam káº¿t gá»­i cho má»—i bÃªn liÃªn quan nhá»¯ng gÃ¬ há» cÃ³ á»Ÿ phÃ­a cá»§a mÃ¬nh trong kÃªnh. Khi má»™t giao dá»‹ch xáº£y ra trong kÃªnh, cÃ¡c bÃªn liÃªn quan cam káº¿t vá»›i tráº¡ng thÃ¡i má»›i báº±ng cÃ¡ch há»§y bá» tráº¡ng thÃ¡i cÅ© vÃ  xÃ¢y dá»±ng má»™t giao dá»‹ch cam káº¿t má»›i.

![instruction](assets/chapitre12/1.webp)

CÃ¡c cáº·p báº£o vá»‡ mÃ¬nh khá»i gian láº­n vá»›i cÃ¡c khÃ³a há»§y bá» vÃ  khÃ³a thá»i gian. ÄÃ³ng kÃªnh báº±ng sá»± Ä‘á»“ng thuáº­n láº«n nhau Ä‘Æ°á»£c Æ°u tiÃªn Ä‘á»ƒ Ä‘Ã³ng kÃªnh. Trong trÆ°á»ng há»£p Ä‘Ã³ng kÃªnh báº¯t buá»™c, giao dá»‹ch cam káº¿t cuá»‘i cÃ¹ng Ä‘Æ°á»£c cÃ´ng bá»‘.

![instruction](assets/chapitre12/3.webp)

CÃ¡c khoáº£n thanh toÃ¡n cÃ³ thá»ƒ mÆ°á»£n kÃªnh tá»« cÃ¡c node trung gian khÃ¡c. CÃ¡c khoáº£n thanh toÃ¡n Ä‘iá»u kiá»‡n dá»±a trÃªn khÃ³a thá»i gian hash (HTLC) cho phÃ©p khÃ³a tiá»n cho Ä‘áº¿n khi thanh toÃ¡n Ä‘Æ°á»£c giáº£i quyáº¿t hoÃ n toÃ n. Onion routing Ä‘Æ°á»£c sá»­ dá»¥ng trong Lightning Network. CÃ¡c node trung gian khÃ´ng biáº¿t Ä‘iá»ƒm Ä‘áº¿n cuá»‘i cÃ¹ng cá»§a cÃ¡c khoáº£n thanh toÃ¡n. Alice pháº£i tÃ­nh toÃ¡n lá»™ trÃ¬nh thanh toÃ¡n, nhÆ°ng khÃ´ng cÃ³ táº¥t cáº£ thÃ´ng tin vá» thanh khoáº£n trong cÃ¡c kÃªnh trung gian.

![instruction](assets/chapitre12/4.webp)

CÃ³ má»™t yáº¿u tá»‘ xÃ¡c suáº¥t khi gá»­i má»™t khoáº£n thanh toÃ¡n qua Lightning Network.

![instruction](assets/chapitre12/5.webp)

Äá»ƒ nháº­n thanh toÃ¡n, thanh khoáº£n pháº£i Ä‘Æ°á»£c quáº£n lÃ½ trong cÃ¡c kÃªnh, cÃ³ thá»ƒ Ä‘Æ°á»£c thá»±c hiá»‡n báº±ng cÃ¡ch yÃªu cáº§u ngÆ°á»i khÃ¡c má»Ÿ kÃªnh cho chÃºng ta, tá»± má»Ÿ kÃªnh, vÃ  sá»­ dá»¥ng cÃ¡c cÃ´ng cá»¥ nhÆ° Loop hoáº·c mua/thuÃª kÃªnh trÃªn cÃ¡c thá»‹ trÆ°á»ng.


## Phá»ng váº¥n Fanis
<chapterId>077cb5f5-1626-5da5-9964-e67b1de503bf</chapterId>

DÆ°á»›i Ä‘Ã¢y lÃ  tÃ³m táº¯t cá»§a cuá»™c phá»ng váº¥n:
Máº¡ng LÆ°á»›i Lightning lÃ  má»™t giáº£i phÃ¡p thanh toÃ¡n cá»±c ká»³ nhanh trÃªn Bitcoin, cho phÃ©p vÆ°á»£t qua cÃ¡c háº¡n cháº¿ liÃªn quan Ä‘áº¿n kháº£ nÄƒng má»Ÿ rá»™ng cá»§a máº¡ng. Tuy nhiÃªn, bitcoin trÃªn Lightning khÃ´ng an toÃ n nhÆ° trÃªn chuá»—i Bitcoin vÃ¬ sá»± phÃ¢n cáº¥p vÃ  an ninh Ä‘Æ°á»£c Æ°u tiÃªn hÆ¡n kháº£ nÄƒng má»Ÿ rá»™ng.

Viá»‡c tÄƒng kÃ­ch thÆ°á»›c khá»‘i quÃ¡ má»©c khÃ´ng pháº£i lÃ  giáº£i phÃ¡p tá»‘t vÃ¬ nÃ³ lÃ m áº£nh hÆ°á»Ÿng Ä‘áº¿n cÃ¡c nÃºt vÃ  kháº£ nÄƒng lÆ°u trá»¯ dá»¯ liá»‡u. Thay vÃ o Ä‘Ã³, Máº¡ng LÆ°á»›i Lightning cho phÃ©p táº¡o cÃ¡c kÃªnh thanh toÃ¡n giá»¯a hai ngÆ°á»i dÃ¹ng Bitcoin mÃ  khÃ´ng hiá»ƒn thá»‹ giao dá»‹ch trÃªn blockchain, tiáº¿t kiá»‡m khÃ´ng gian trÃªn cÃ¡c khá»‘i vÃ  cho phÃ©p Bitcoin má»Ÿ rá»™ng ngÃ y nay.

Tuy nhiÃªn, cÃ³ nhá»¯ng chá»‰ trÃ­ch vá» kháº£ nÄƒng má»Ÿ rá»™ng vÃ  sá»± táº­p trung cá»§a Máº¡ng LÆ°á»›i Lightning, vá»›i cÃ¡c váº¥n Ä‘á» tiá»m áº©n liÃªn quan Ä‘áº¿n viá»‡c Ä‘Ã³ng kÃªnh vÃ  phÃ­ giao dá»‹ch cao. Äá»ƒ giáº£i quyáº¿t nhá»¯ng váº¥n Ä‘á» nÃ y, ngÆ°á»i ta khuyáº¿n nghá»‹ trÃ¡nh má»Ÿ cÃ¡c kÃªnh nhá» Ä‘á»ƒ trÃ¡nh váº¥n Ä‘á» trong tÆ°Æ¡ng lai vÃ  tÄƒng phÃ­ giao dá»‹ch vá»›i Child Pay for Parent.

CÃ¡c giáº£i phÃ¡p Ä‘Æ°á»£c xem xÃ©t cho tÆ°Æ¡ng lai cá»§a Máº¡ng LÆ°á»›i Lightning bao gá»“m viá»‡c gá»™p lÃ´ vÃ  táº¡o kÃªnh theo nhÃ³m Ä‘á»ƒ giáº£m phÃ­ giao dá»‹ch, cÅ©ng nhÆ° tÄƒng kÃ­ch thÆ°á»›c khá»‘i trong dÃ i háº¡n. Tuy nhiÃªn, quan trá»ng lÃ  pháº£i lÆ°u Ã½ ráº±ng bitcoin trÃªn Lightning khÃ´ng an toÃ n nhÆ° bitcoin trÃªn chuá»—i Bitcoin.

Sá»± riÃªng tÆ° trÃªn Bitcoin vÃ  Lightning Ä‘Æ°á»£c liÃªn káº¿t, vá»›i viá»‡c sá»­ dá»¥ng onion routing Ä‘áº£m báº£o má»™t má»©c Ä‘á»™ riÃªng tÆ° nháº¥t Ä‘á»‹nh cho cÃ¡c giao dá»‹ch. Tuy nhiÃªn, trÃªn Bitcoin, má»i thá»© Ä‘á»u minh báº¡ch theo máº·c Ä‘á»‹nh, vá»›i cÃ¡c phÃ©p suy luáº­n Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ theo dÃµi Bitcoin tá»« Ä‘á»‹a chá»‰ nÃ y sang Ä‘á»‹a chá»‰ khÃ¡c trÃªn chuá»—i Bitcoin.

Mua Bitcoin vá»›i KYC cho phÃ©p sÃ n giao dá»‹ch biáº¿t cÃ¡c giao dá»‹ch rÃºt tiá»n, trong khi cÃ¡c sá»‘ tiá»n trÃ²n vÃ  Ä‘á»‹a chá»‰ thay Ä‘á»•i cho phÃ©p biáº¿t pháº§n nÃ o cá»§a giao dá»‹ch dÃ nh cho ngÆ°á»i khÃ¡c vÃ  pháº§n nÃ o dÃ nh cho báº£n thÃ¢n.

Äá»ƒ cáº£i thiá»‡n sá»± riÃªng tÆ°, cÃ¡c hÃ nh Ä‘á»™ng chung vÃ  coinjoins cho phÃ©p phÃ¡ vá»¡ cÃ¡c phÃ©p tÃ­nh xÃ¡c suáº¥t báº±ng cÃ¡ch thá»±c hiá»‡n cÃ¡c giao dá»‹ch nÆ¡i nhiá»u ngÆ°á»i cÃ¹ng thá»±c hiá»‡n má»™t giao dá»‹ch cÃ¹ng nhau. CÃ¡c cÃ´ng ty phÃ¢n tÃ­ch chuá»—i khÃ³ cÃ³ thá»ƒ xÃ¡c Ä‘á»‹nh báº¡n Ä‘ang lÃ m gÃ¬ vá»›i bitcoin cá»§a mÃ¬nh báº±ng cÃ¡ch theo dÃµi.

TrÃªn Lightning, chá»‰ cÃ³ hai ngÆ°á»i biáº¿t vá» giao dá»‹ch, vÃ  nÃ³ báº£o máº­t hÆ¡n Bitcoin. Onion routing cÃ³ nghÄ©a lÃ  má»™t nÃºt trung gian khÃ´ng biáº¿t ngÆ°á»i gá»­i vÃ  ngÆ°á»i nháº­n thanh toÃ¡n.

Äá»ƒ sá»­ dá»¥ng Máº¡ng LÆ°á»›i Lightning, báº¡n Ä‘Æ°á»£c khuyáº¿n nghá»‹ theo dÃµi má»™t khÃ³a há»c trÃªn kÃªnh YouTube cá»§a báº¡n hoáº·c trá»±c tiáº¿p trÃªn trang web discover Bitcoin, hoáº·c sá»­ dá»¥ng khÃ³a há»c trÃªn Umbrell. CÅ©ng cÃ³ thá»ƒ gá»­i vÄƒn báº£n tÃ¹y Ã½ trong má»™t giao dá»‹ch trÃªn Lightning sá»­ dá»¥ng má»™t trÆ°á»ng dÃ nh riÃªng cho viá»‡c nÃ y, cÃ³ thá»ƒ há»¯u Ã­ch cho viá»‡c quyÃªn gÃ³p hoáº·c nháº¯n tin.
Tuy nhiÃªn, quan trá»ng lÃ  pháº£i lÆ°u Ã½ ráº±ng cÃ¡c nÃºt Ä‘á»‹nh tuyáº¿n Lightning cÃ³ thá»ƒ Ä‘Æ°á»£c quáº£n lÃ½ trong tÆ°Æ¡ng lai, vá»›i má»™t sá»‘ quá»‘c gia cá»‘ gáº¯ng quáº£n lÃ½ cÃ¡c nÃºt Ä‘á»‹nh tuyáº¿n. Äá»‘i vá»›i cÃ¡c nhÃ  bÃ¡n láº», cáº§n quáº£n lÃ½ thanh khoáº£n Ä‘á»ƒ cháº¥p nháº­n thanh toÃ¡n trÃªn Máº¡ng LÆ°á»›i Lightning, vá»›i cÃ¡c háº¡n cháº¿ hiá»‡n táº¡i cÃ³ thá»ƒ Ä‘Æ°á»£c vÆ°á»£t qua vá»›i cÃ¡c giáº£i phÃ¡p phÃ¹ há»£p.

Cuá»‘i cÃ¹ng, tÆ°Æ¡ng lai cá»§a Bitcoin há»©a háº¹n vá»›i má»™t dá»± bÃ¡o cÃ³ thá»ƒ Ä‘áº¡t má»™t triá»‡u trong nÄƒm nÄƒm. Äá»ƒ Ä‘áº£m báº£o sá»± chuyÃªn nghiá»‡p hÃ³a cá»§a ngÃ nh vÃ  táº¡o ra má»™t há»‡ thá»‘ng thay tháº¿ cho há»‡ thá»‘ng ngÃ¢n hÃ ng hiá»‡n táº¡i, quan trá»ng lÃ  pháº£i Ä‘Ã³ng gÃ³p cho máº¡ng lÆ°á»›i vÃ  ngá»«ng tin tÆ°á»Ÿng.



## Cho chÃºng tÃ´i biáº¿t pháº£n há»“i cá»§a báº¡n vá» khÃ³a há»c nÃ y
<chapterId>38814c99-eb7b-5772-af49-4386ee2ce9b0</chapterId>
<isCourseReview>true</isCourseReview>

## Lá»i cáº£m Æ¡n vÃ  tiáº¿p tá»¥c khÃ¡m phÃ¡ há»‘ thá»
<chapterId>afc0d72b-4fbc-5893-90b2-e27fb519ad02</chapterId>

Xin chÃºc má»«ng! ğŸ‰
Báº¡n Ä‘Ã£ hoÃ n thÃ nh khÃ³a LN 201 - Giá»›i thiá»‡u vá» Máº¡ng LÆ°á»›i Lightning!
Báº¡n cÃ³ thá»ƒ tá»± hÃ o vá» báº£n thÃ¢n vÃ¬ Ä‘iá»u nÃ y khÃ´ng há» dá»… dÃ ng. HÃ£y biáº¿t ráº±ng Ã­t ngÆ°á»i Ä‘i sÃ¢u vÃ o há»‘ thá» Bitcoin nhÆ° váº­y.

TrÆ°á»›c háº¿t, má»™t lá»i cáº£m Æ¡n lá»›n Ä‘áº¿n Fanis Makalakis vÃ¬ Ä‘Ã£ cung cáº¥p cho chÃºng tÃ´i khÃ³a há»c miá»…n phÃ­ tuyá»‡t vá»i nÃ y vá» khÃ­a cáº¡nh dÃ¢n tá»™c há»c cá»§a Lightning. Äá»«ng ngáº§n ngáº¡i theo dÃµi anh áº¥y trÃªn Twitter, trÃªn blog cá»§a mÃ¬nh, hoáº·c qua cÃ´ng viá»‡c cá»§a anh áº¥y táº¡i thá»‹ trÆ°á»ng LN.

Sau Ä‘Ã³, náº¿u báº¡n muá»‘n giÃºp Ä‘á»¡ dá»± Ã¡n, Ä‘á»«ng ngáº§n ngáº¡i tÃ i trá»£ cho chÃºng tÃ´i trÃªn Patreon. QuyÃªn gÃ³p cá»§a báº¡n sáº½ Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ sáº£n xuáº¥t ná»™i dung cho cÃ¡c khÃ³a há»c má»›i vÃ  táº¥t nhiÃªn, báº¡n sáº½ lÃ  ngÆ°á»i Ä‘áº§u tiÃªn Ä‘Æ°á»£c thÃ´ng bÃ¡o (bao gá»“m cáº£ khÃ³a há»c tiáº¿p theo cá»§a Fanis Ä‘ang Ä‘Æ°á»£c thá»±c hiá»‡n!).

Cuá»™c phiÃªu lÆ°u Máº¡ng LÆ°á»›i Lightning tiáº¿p tá»¥c vá»›i khÃ³a há»c Umbrel vÃ  viá»‡c triá»ƒn khai má»™t nÃºt Máº¡ng LÆ°á»›i Lightning. LÃ½ thuyáº¿t Ä‘Ã£ káº¿t thÃºc vÃ  Ä‘Ã£ Ä‘áº¿n lÃºc thá»±c hÃ nh vá»›i khÃ³a há»c LN 202 bÃ¢y giá»!
RogzyHÃ´n vÃ  háº¹n gáº·p láº¡i báº¡n sá»›m!
