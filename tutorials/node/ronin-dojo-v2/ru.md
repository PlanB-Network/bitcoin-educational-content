---
name: RoninDojo v2
description: Установка вашего Bitcoin-нода RoninDojo v2 на Raspberry Pi
---
![обложка RoninDojo v2](assets/cover.webp)

***ВНИМАНИЕ:** После ареста основателей кошелька Samourai и изъятия их серверов 24 апреля, некоторые функции RoninDojo, такие как Whirlpool, больше не работают. Тем не менее, возможно, что эти инструменты могут быть восстановлены или запущены по-новому в ближайшие недели. Кроме того, поскольку код RoninDojo был размещен на GitLab Samourai, который также был изъят, в настоящее время невозможно удаленно загрузить код. Вероятно, команды RoninDojo работают над повторной публикацией кода.*

_Мы тщательно следим за развитием этого дела, а также за развитием связанных с ним инструментов. Можете быть уверены, что мы обновим этот учебник, как только появится новая информация._

_Этот учебник предоставляется только для образовательных и информационных целей. Мы не поддерживаем и не поощряем использование этих инструментов в преступных целях. Каждый пользователь несет ответственность за соблюдение законов в своей юрисдикции._

---

> "*Используйте Bitcoin конфиденциально.*"

В предыдущем учебнике мы уже объясняли процедуру установки и использования RoninDojo v1. Однако за последний год команды RoninDojo запустили версию 2 своей реализации, которая стала значительным поворотным моментом в архитектуре программного обеспечения. Действительно, они отказались от дистрибутива Linux Manjaro в пользу Debian. Следовательно, они больше не предлагают предварительно настроенный образ для автоматической установки на Raspberry Pi. Но все еще существует метод для проведения ручной установки. Я использовал его для своего собственного нода, и с тех пор RoninDojo v2 замечательно работает на моем Raspberry Pi 4. Поэтому я предлагаю новый учебник по ручной установке RoninDojo v2 на Raspberry Pi.

https://planb.network/tutorials/node/ronin-dojo



## Содержание:
- Что такое RoninDojo?
- Какое оборудование выбрать для установки RoninDojo v2?
- Как собрать Raspberry Pi 4?
- Как установить RoninDojo v2 на Raspberry Pi 4?
- Как использовать ваш нод RoninDojo v2?

## Что такое RoninDojo?
Dojo изначально является полной реализацией Bitcoin-нода, основанной на Bitcoin Core, и разработанной командами кошелька Samourai. Это решение может быть установлено на любом оборудовании. В отличие от других реализаций Core, Dojo был специально оптимизирован для интеграции с Android-приложением кошелька Samourai. Что касается RoninDojo, это утилита, предназначенная для облегчения установки и управления Dojo, а также различных других дополнительных инструментов. Короче говоря, RoninDojo обогащает базовую реализацию Dojo, интегрируя множество дополнительных инструментов, одновременно упрощая его установку и управление.

Ronin также предлагает [решение "нод в коробке", называемое "*Tanto*"](https://ronindojo.io/en/products), устройство с уже установленным на нем RoninDojo, собранное их командой. Tanto является платным вариантом, который может быть интересен тем, кто предпочитает избегать технических сложностей. Но поскольку исходный код RoninDojo открыт, его также можно развернуть на собственном оборудовании. Этот альтернативный, более экономичный вариант, тем не менее, требует некоторых дополнительных манипуляций, которые мы рассмотрим в этом учебнике.
RoninDojo является Dojo, что позволяет легко интегрировать Whirlpool CLI в ваш Bitcoin-нод, чтобы обеспечить наилучший возможный опыт coinjoin. С Whirlpool CLI становится возможным непрерывно перемешивать ваши биткоины 24 часа в сутки, 7 дней в неделю, без необходимости оставлять ваш личный компьютер включенным.
Помимо Whirlpool CLI, RoninDojo включает в себя различные инструменты для расширения функциональности вашего Dojo. Среди них, калькулятор Boltzmann анализирует уровень конфиденциальности ваших транзакций, сервер Electrum позволяет подключать ваши Bitcoin-кошельки к вашему ноду, а сервер Mempool дает возможность локально просматривать ваши транзакции, не раскрывая информацию.

По сравнению с другими решениями для нод, такими как Umbrel, RoninDojo явно сосредоточен на решениях для on-chain и инструментах конфиденциальности. В отличие от Umbrel, RoninDojo не поддерживает настройку Lightning-нода или интеграцию более общих серверных приложений. Хотя RoninDojo предлагает меньше универсальных инструментов, чем Umbrel, он обладает всеми необходимыми функциями для управления вашей on-chain активностью.

Если вам не нужны универсальные функции или те, что связаны с Lightning Network, как предлагает Umbrel, и вы ищете простой, стабильный нод с основными инструментами, такими как Whirlpool или Mempool, RoninDojo может стать идеальным решением. В то время как Umbrel стремится стать мини-мультитаскинг сервером, ориентированным на Lightning Network и универсальность, RoninDojo, следуя философии Samourai Wallet, сосредоточен на основных инструментах для конфиденциальности пользователя.

Теперь, когда мы описали RoninDojo, давайте вместе посмотрим, как настроить этот нод.

## Какое оборудование выбрать для установки RoninDojo v2?
RoninDojo предлагает образ для автоматической установки своего программного обеспечения на [RockPro64](https://ronindojo.io/en/download). Однако наше руководство сосредоточено на процедуре ручной установки на Raspberry Pi 4. Хотя недавно был запущен Raspberry Pi 5, и это руководство теоретически должно быть совместимо с этой новой моделью, я еще не имел возможности лично его протестировать и не нашел отзывов от сообщества. Как только я приобрету Pi 5 и совместимые компоненты, я обновлю это руководство, чтобы держать вас в курсе. Тем временем, я рекомендую отдать предпочтение Pi 4, так как он отлично работает для моего нода.
С моей стороны, я использую RoninDojo на Raspberry Pi с 8 ГБ оперативной памяти. Хотя некоторые члены сообщества смогли заставить его работать на устройствах только с 4 ГБ оперативной памяти, я сам не тестировал эту конфигурацию. Учитывая небольшую разницу в цене, кажется разумным выбрать версию с 8 ГБ оперативной памяти. Это также может оказаться полезным, если вы планируете использовать ваш Raspberry Pi для других целей в будущем.
Важно отметить, что команды RoninDojo сообщали о частых проблемах, связанных с корпусом и адаптером SSD. Я столкнулся с этими проблемами сам. **Поэтому настоятельно рекомендуется избегать корпусов, оснащенных USB-кабелем для SSD вашего нода.** Вместо этого предпочтите карту расширения памяти, специально разработанную для вашего Raspberry Pi:

![карта расширения памяти RPI4](assets/notext/1.webp)
Для хранения блокчейна Bitcoin вам понадобится SSD, совместимый с картой расширения памяти, которую вы выбрали. На данный момент (февраль 2024 года) мы находимся в переходной фазе. Ожидается, что через несколько месяцев диски на 1 ТБ уже не будут достаточны для хранения растущего размера блокчейна, особенно учитывая различные приложения, которые вы планируете интегрировать в свой узел. Поэтому некоторые рекомендуют инвестировать в SSD на 2 ТБ для спокойствия на долгосрочную перспективу. Однако, учитывая годовую тенденцию к снижению цен на SSD, другие предлагают остановиться на диске на 1 ТБ, который должен быть достаточным на один или два года, аргументируя это тем, что к моменту его устаревания стоимость моделей на 2 ТБ, вероятно, снизится. Таким образом, выбор зависит от ваших личных предпочтений. Если вы планируете использовать свой RoninDojo длительное время и хотите избежать любых технических манипуляций в ближайшие годы, вариант с SSD на 2 ТБ кажется наиболее разумным, так как он предоставляет вам комфортный запас на будущее.
Кроме того, вам понадобятся различные мелкие компоненты:
- Корпус с вентилятором для размещения вашего Raspberry Pi и карты расширения памяти. В интернете доступны комплекты, включающие как карту расширения SSD, так и совместимый корпус;
- Питающий кабель для вашего Raspberry Pi;
- Микро SD-карта объемом не менее 16 ГБ (хотя технически достаточно и 8 ГБ, разница в цене между картами на 8 и 16 ГБ часто незначительна);
- Сетевой кабель RJ45 Ethernet для подключения к сети.

![node material](assets/notext/2.webp)

## Как собрать Raspberry Pi 4?
Сборка вашего узла будет варьироваться в зависимости от выбранного оборудования, особенно типа корпуса. Однако общий план действий при сборке остается в целом похожим.
Начните с установки вашего SSD на карту расширения памяти, уделяя внимание закреплению двух винтов на задней части.

![assembly1](assets/notext/3.webp)

Затем прикрепите ваш Raspberry Pi к карте расширения.

![assembly2](assets/notext/4.webp)

Также прикрепите вентилятор к Raspberry Pi.

![assembly3](assets/notext/5.webp)

Подключите различные компоненты, обращая внимание на использование правильных контактов, ссылаясь на руководство к вашему корпусу. Производители корпусов часто предлагают видеоуроки, чтобы помочь вам в сборке. В моем случае у меня есть дополнительная карта расширения, оснащенная кнопкой включения/выключения. Это не обязательно для создания узла Bitcoin. Я в основном использую его, чтобы иметь кнопку питания.

Если, как и я, у вас есть карта расширения с кнопкой включения/выключения, не забудьте установить маленький перемычку "Auto Power On". Это позволит вашему узлу автоматически запускаться, как только он будет подключен к питанию. Эта функция особенно полезна в случае отключения электроэнергии, так как позволяет вашему узлу перезапускаться самостоятельно, без ручного вмешательства с вашей стороны.

![assembly4](assets/notext/6.webp)

Перед тем как поместить всё оборудование в корпус, важно проверить правильную работу вашего Raspberry Pi, карты расширения памяти и вентилятора, включив их. 

![assembly5](assets/notext/7.webp)
Наконец, установите ваш Raspberry Pi в его корпус. Обратите внимание, что на более позднем этапе потребуется добавить micro SD карту в соответствующий порт на Raspberry Pi. Если ваш корпус оснащен отверстием, которое позволяет вставить SD карту, не открывая его (как это сделано в моем случае, показанном на фото), вы можете закрыть корпус сейчас. Однако, если ваш корпус не имеет прямого доступа к порту micro SD, вам нужно будет подождать, пока вы подготовите micro SD карту для вставки перед окончательной сборкой.

## Как установить RoninDojo v2 на Raspberry Pi 4?

### Шаг 1: Подготовка загрузочной micro SD
После сборки вашего оборудования следующим шагом будет установка RoninDojo. Для этого мы подготовим загрузочную micro SD карту с вашего компьютера, записав на неё соответствующий образ диска.
Вам нужно будет использовать программное обеспечение _**Raspberry Pi Imager**_, предназначенное для упрощения загрузки, настройки и записи операционных систем на micro SD карту для использования с Raspberry Pi. Начните с установки этого программного обеспечения на ваш личный ПК:
- Для Ubuntu/Debian: https://downloads.raspberrypi.org/imager/imager_latest_amd64.deb
- Для Windows: https://downloads.raspberrypi.org/imager/imager_latest.exe
- Для Mac: https://downloads.raspberrypi.org/imager/imager_latest.dmg

После установки программного обеспечения откройте его и вставьте вашу micro SD карту в ваш личный компьютер. В интерфейсе Raspberry Pi Imager выберите `CHOOSE OS`:

Далее перейдите в меню `Raspberry Pi OS (other)`:

Выберите операционную систему под названием `Raspberry Pi OS (Legacy, 64-bit) Lite`, размером `0.3 GB`:

После выбора операционной системы вы будете перенаправлены в главное меню Raspberry Pi Imager. Нажмите на `CHOOSE STORAGE`:

Выберите вашу micro SD карту:

После выбора операционной системы и micro SD карты нажмите на `NEXT`:

Появится новое окно. Выберите `EDIT CONFIGURATION`:

В этом окне перейдите на вкладку `GENERAL` и сделайте следующие настройки (которые очень важны для его работы):
- Включите опцию и присвойте `RoninDojo` в качестве имени хоста;
- Включите `Set username and password`, введите `pi` в качестве имени пользователя, выберите пароль и запишите эту информацию, так как она понадобится позже. Эти учетные данные являются временными и будут удалены позже;
- Отключите `Configure Wi-Fi`;
- Включите `Set locale settings` и выберите ваш часовой пояс, а также тип клавиатуры, соответствующий вашему компьютеру;

На вкладке SERVICES установите флажок `Enable SSH` и выберите `Use a password for authentication`:

Также убедитесь, что на вкладке `OPTIONS` телеметрия отключена:

Нажмите на `SAVE`:
Подтвердите, нажав на `YES`, чтобы начать создание загрузочной micro SD карты:
![settings save](assets/notext/19.webp)

Сообщение уведомит вас о том, что все данные на micro SD карте будут стерты. Подтвердите, нажав на `YES`, чтобы начать процесс:

![overwrite micro SD](assets/notext/21.webp)

Дождитесь, пока программа закончит подготовку вашей micro SD карты:

![writing micro SD](assets/notext/22.webp)

Когда появится сообщение о завершении процесса, вы можете извлечь micro SD карту из компьютера:

![writing micro SD completed](assets/notext/23.webp)

### Шаг 2: Завершение сборки узла
Теперь вы можете вставить micro SD карту в соответствующий порт вашего Raspberry Pi.

![micro SD](assets/notext/24.webp)

Затем подключите ваш Raspberry Pi к роутеру с помощью Ethernet кабеля. Наконец, включите ваш узел, подключив кабель питания и нажав кнопку питания (если ваша конфигурация ее предусматривает).

### Шаг 3: Установление SSH-соединения с узлом
Сначала необходимо найти IP-адрес вашего узла. Вы можете использовать такой инструмент, как _[Advanced IP Scanner](https://www.advanced-ip-scanner.com/)_ или _[Angry IP Scanner](https://angryip.org/)_, или проверить административный интерфейс вашего роутера. IP-адрес должен быть в формате `192.168.1.??`. **Для всех следующих команд замените `[IP]` на фактический IP-адрес вашего узла**, (убрав скобки).

Запустите терминал.

Чтобы удалить возможный ключ, уже ассоциированный с IP-адресом вашего узла, выполните команду: 
`ssh-keygen -R [IP]`. 

Ошибка после этой команды не является серьезной; это просто означает, что ключа нет в вашем списке известных хостов (что довольно вероятно). Например, если IP вашего узла `192.168.1.40`, команда становится: `ssh-keygen -R 192.168.1.40`.

Далее, установите SSH-соединение с вашим узлом, выполнив команду: 
`ssh pi@[IP]`.
Появится сообщение о подлинности хоста: `The authenticity of host '[IP]' can't be established.` Это указывает на то, что подлинность устройства, к которому вы пытаетесь подключиться, не может быть проверена из-за отсутствия известного публичного ключа. При первом подключении по SSH к новому хосту это сообщение всегда появляется. Вы должны ответить `yes`, чтобы добавить его публичный ключ в ваш локальный каталог, что предотвратит появление этого предупреждающего сообщения при будущих SSH-соединениях с этим узлом. Поэтому введите `yes` и нажмите `enter`, чтобы подтвердить.
Затем вас попросят ввести ваш пароль, установленный ранее как временный на шаге 1. Подтвердите, нажав `enter`. Теперь вы подключены к вашему узлу через SSH.

Вкратце, вот команды для выполнения:
- `ssh-keygen -R [IP]`
- `ssh pi@[IP]`
- `yes`
- Введите временный пароль и подтвердите.

### Шаг 4: Обновление и подготовка
Теперь вы подключены к вашему узлу через SSH-сессию. В вашем терминале приглашение командной строки должно быть: `pi@RoninDojo:~ $`. Для начала обновите список доступных пакетов и установите обновления для существующих пакетов с помощью следующей команды:
`sudo apt update && sudo apt upgrade -y`
После завершения обновлений приступите к установке *Git* и *Dialog* с помощью команды: `sudo apt install git dialog -y`

Далее, клонируйте ветку `master` Git-репозитория _RoninOS_, выполнив:
`sudo git clone --branch master https://code.samourai.io/ronindojo/RoninOS.git /opt/RoninOS`

Запустите скрипт `customize-image.sh` с командой:
`cd /opt/RoninOS/ && sudo ./customize-image.sh`

**Важно дать скрипту выполниться без прерываний и терпеливо дождаться окончания процесса**, что займет около 10 минут. Когда появится сообщение `Настройка завершена`, можно переходить к следующему шагу.

### Шаг 5: Запуск RoninOS
Запустите RoninOS с помощью команды:
`sudo systemctl start ronin-setup`

Отобразите строки файла журнала с помощью команды:
`tail -f /home/ronindojo/.logs/setup.logs`

На этом этапе **важно дать RoninOS запуститься и дождаться его завершения работы**. Это займет около 40 минут. Когда появится `Все установки функций RoninDojo завершены!`, можно переходить к шагу 6.

### Шаг 6: Доступ к RoninUI и изменение учетных данных
После завершения установки, чтобы подключиться к вашему узлу через браузер, убедитесь, что ваш личный компьютер подключен к той же локальной сети, что и ваш узел. Если вы используете VPN на своем устройстве, временно отключите его. Чтобы получить доступ к интерфейсу узла в вашем браузере, введите в адресную строку:
- Непосредственно IP-адрес вашего узла, например, `192.168.1.??`;
- Или введите `ronindojo.local`.

Попав на домашнюю страницу RoninUI, вас попросят начать настройку. Для этого нажмите на кнопку `Давайте начнем`.

![давайте начнем](assets/notext/25.webp)

На этом этапе RoninUI представит вам ваш пароль `root`. Очень важно сохранить его в безопасности. Вы можете выбрать физическое сохранение, на бумаге, или сохранить его в [менеджере паролей](https://planb.network/courses/secu101/4/2).

![пароль root](assets/notext/26.webp)

После сохранения пароля `root` отметьте галочку `Я сохранил учетные данные пользователя Root` и нажмите `Продолжить`, чтобы перейти дальше.

![подтверждение пароля root](assets/notext/27.webp)

Следующий шаг включает создание пароля пользователя, который будет использоваться как для доступа к веб-интерфейсу RoninUI, так и для установления SSH-сессий с вашим узлом. Выберите надежный пароль и обязательно сохраните его в безопасности. Вам нужно будет ввести этот пароль дважды, прежде чем нажать на `Завершить`, чтобы подтвердить. Что касается имени пользователя, рекомендуется оставить выбор по умолчанию, `ronindojo`. Если вы решите его изменить, не забудьте соответствующим образом скорректировать команды на следующих шагах.

![учетные данные пользователя](assets/notext/28.webp)

После выполнения этих действий дождитесь инициализации вашего узла. Затем вы получите доступ к веб-интерфейсу RoninUI. Вы почти у конца процесса, осталось всего несколько мелких шагов!
![Ronin UI](assets/notext/29.webp)

### Шаг 7: Удаление временных учетных данных
Откройте новый терминал на вашем личном компьютере и установите SSH-соединение с вашим узлом, используя следующую команду:
`SSH ronindojo@[IP]`
Если, например, IP-адрес вашего узла `192.168.1.40`, соответствующая команда будет: `SSH ronindojo@192.168.1.40`

Если вы изменили свое имя пользователя на предыдущем этапе, заменив имя пользователя по умолчанию (`ronindojo`) на другое, убедитесь, что используете это новое имя в команде. Например, если вы выбрали `planb` в качестве имени пользователя и IP-адрес `192.168.1.40`, то команда для ввода будет:
`SSH planb@192.168.1.40`
Вас попросят ввести пароль пользователя. Введите его, а затем нажмите `enter`, чтобы подтвердить. После этого вы получите доступ к интерфейсу RoninCLI. Используйте стрелки на клавиатуре для навигации к опции `Exit RoninDojo` и нажмите `enter`, чтобы выбрать ее.
![RoninCLI](assets/notext/30.webp)

На этом этапе вы находитесь в терминале вашего узла, с приглашением командной строки, похожим на: `ronindojo@RoninDojo:~ $`. Чтобы удалить временного пользователя, созданного во время настройки загрузочной micro SD карты, введите следующую команду и нажмите `enter`:
`sudo deluser --remove-home pi`

Вас попросят подтвердить ваш пароль пользователя. Введите его и подтвердите, нажав `enter`. Дождитесь завершения операции, затем используйте команду `exit`, чтобы выйти из терминала.

Поздравляем! Ваш узел RoninDojo v2 теперь настроен и готов к использованию. Он начнет IBD (*Initial Block Download*), приступая к загрузке и проверке блокчейна Bitcoin с Genesis блока. Этот шаг включает в себя получение всех транзакций Bitcoin, совершенных с 3 января 2009 года, и занимает некоторое время. Как только блокчейн будет полностью загружен, индексатор приступит к сжатию базы данных. Продолжительность IBD может значительно варьироваться. Ваш узел RoninDojo будет полностью оперативным после завершения этого процесса.

**Если вы переходите с старого узла RoninDojo v1** на эту новую версию с этим руководством, сохраняя при этом тот же SSD, ваш узел должен автоматически обнаружить и повторно использовать существующие данные на диске, избавляя вас от необходимости выполнять IBD снова. В этом случае вам просто нужно будет дождаться, пока ваш узел ресинхронизируется с последними блоками.

### Шаг 8: "veth* fix"
Если вы столкнулись с ошибкой на вашем узле RoninDojo v2 на Raspberry Pi, когда после безпроблемной установки ваш узел внезапно становится недоступным через SSH, но восстанавливается после простой перезагрузки, тогда вам нужно выполнить этот шаг 8. Эту распространенную ошибку можно легко исправить с помощью решения, разработанного сообществом: "_veth fix_". Это незначительное исправление навсегда устраняет внезапные отключения. Вот как его применить.

Откройте новый терминал на вашем личном компьютере и установите SSH-соединение с вашим узлом, используя следующую команду:
`SSH ronindojo@[IP]`

Если, например, IP-адрес вашего узла `192.168.1.40`, соответствующая команда будет:
`SSH ronindojo@192.168.1.40`

Вас попросят ввести пароль пользователя. Введите его и нажмите `enter`, чтобы подтвердить. После этого вы получите доступ к интерфейсу RoninCLI. Используйте стрелки на клавиатуре для навигации к опции `Exit RoninDojo` и нажмите `enter`, чтобы выбрать ее.
На данном этапе вы находитесь в терминале вашего узла, с приглашением командной строки, похожим на: `ronindojo@RoninDojo:~ $`. Чтобы применить исправление veth*, введите следующую команду и нажмите `enter`: `sudo nano /etc/dhcpcd.conf`

Подтвердите свой пароль еще раз и нажмите `enter`.

Вы попадете в файл `dhcpcd.conf`. Вам нужно скопировать следующий текст, убедившись, что включили звездочку, и добавить его в конец файла: 
`denyinterfaces veth*`

Для этого переместитесь в конец файла, используя стрелку вниз на клавиатуре, затем используйте правую кнопку мыши, чтобы вставить текст на отдельной строке.

После добавления текста нажмите `ctrl X`, чтобы начать выход, затем `ctrl Y`, чтобы подтвердить сохранение изменений, и нажмите `enter`, чтобы завершить и вернуться к приглашению командной строки. Чтобы убедиться, что модификация была правильно применена, снова откройте файл `dhcpcd.conf`, используя соответствующую команду.

Чтобы завершить применение исправления, перезагрузите ваш узел, выполнив: 
`sudo reboot now`

На этом этапе вы можете закрыть терминал. Дайте необходимое время для перезагрузки вашего RoninDojo, после чего вы сможете снова подключиться через графический интерфейс вашего браузера. Этот процесс должен исправить обнаруженную ошибку.

## Как использовать ваш узел RoninDojo v2?

### Подключение вашего программного кошелька к Electrs
Первое использование вашего недавно установленного и синхронизированного узла будет заключаться в том, чтобы транслировать ваши транзакции в сеть Bitcoin. Вероятно, вы захотите подключить ваши различные кошельки к вашему узлу, чтобы транслировать ваши транзакции конфиденциально. Вы можете сделать это через Electrum Rust Server (electrs). Это приложение обычно предустановлено на вашем узле RoninDojo. Если нет, вы можете установить его вручную через интерфейс RoninCLI в `Applications > Manage Applications > Install Electrum Server`.

Чтобы получить адрес Tor вашего Electrum Server, в веб-интерфейсе RoninUI перейдите к:
`Pairing > Electrum server > Pair now`
![Pairing](assets/notext/31.webp)
![Electrs](assets/notext/32.webp)
Затем вам нужно будет ввести адрес `Hostname`, заканчивающийся на `.onion`, в вашем программном кошельке, сопровождаемый портом `50001`. ![hostname](assets/notext/33.webp)
Например, в Sparrow Wallet просто перейдите на вкладку:
`File > Preferences > Server > Private Electrum`

![Sparrow](assets/notext/34.webp)

### Подключение вашего программного кошелька к Samourai Dojo
В качестве альтернативы использованию Electrs, Dojo позволяет подключать ваш совместимый программный кошелек напрямую к вашему узлу RoninDojo. Кошельки, такие как Samourai Wallet и Sentinel, предлагают эту функциональность.

Для установления соединения вам просто нужно будет отсканировать QR-код вашего Dojo. Чтобы получить доступ к этому QR-коду через RoninUI, перейдите к:
`Pairing > Samourai Dojo > Pair now`
![Samourai Dojo](assets/notext/35.webp)
Чтобы связать ваш Samourai Wallet с вашим Dojo, просто отсканируйте этот QR-код во время установки приложения:

![Samourai Wallet connection](assets/notext/36.webp)
Если у вас уже был кошелек Samourai до настройки вашего Ronin Dojo, необходимо сделать резервную копию вашего кошелька, удалить, а затем переустановить приложение Samourai Wallet, прежде чем восстановить ваш кошелек. При запуске переустановленного приложения у вас будет возможность подключиться к новому Dojo. **Будьте осторожны, этот процесс несет риск потери ваших биткойнов, если он не выполнен правильно!** Убедитесь, что у вас есть резервная копия вашего кошелька Samourai в ваших файлах и проверьте валидность вашей парольной фразы через `Настройки > Устранение неполадок > Парольная фраза`. Также важно иметь читаемую резервную копию вашей фразы восстановления и вашей парольной фразы. Для большей точности в этой операции рекомендуется следовать этому подробному руководству: [https://wiki.ronindojo.io/en/setup/v2_0_0-upgrade/reconnectsamourai](https://wiki.ronindojo.io/en/setup/v2_0_0-upgrade/reconnectsamourai).
### Использование собственного блок-эксплорера Mempool.space
Блок-эксплорер преобразует сырые данные из блокчейна Bitcoin в структурированный и легко читаемый формат. С помощью инструментов, таких как *Mempool.space*, можно анализировать транзакции, искать конкретные адреса или даже консультироваться со средними ставками комиссий мемпулов сети в реальном времени.

Однако использование онлайн блок-эксплореров несет риски для вашей конфиденциальности и влечет за собой доверие к данным, предоставляемым третьими сторонами. Действительно, используя эти услуги без прохождения через собственный узел, вы можете непреднамеренно раскрыть информацию о своих транзакциях и должны полагаться на точность информации, представленной владельцем сайта.
Чтобы снизить эти риски, рекомендуется использовать собственный экземпляр *Mempool.space* через сеть Tor, напрямую размещенный на вашем узле. Это решение обеспечивает сохранение вашей конфиденциальности и автономность ваших данных.
Для этого начните с установки *Mempool Space Visualizer* из RoninUI. В веб-интерфейсе перейдите на вкладку `Dashboard` и нажмите на `Manage` ниже `Mempool Space`:
`Dashboard > Mempool Space > Manage`
![Управление мемпулом](assets/notext/37.webp)
Затем нажмите на кнопку `Install Mempool visualizer`:
![установка мемпула](assets/notext/38.webp)
Подтвердите свой пользовательский пароль:
![пароль мемпула](assets/notext/39.webp)
Дождитесь завершения установки, затем снова нажмите на кнопку `Manage`:
![Управление Mempool](assets/notext/40.webp)
Вы получите ссылку `.onion` для доступа к вашему собственному экземпляру *Mempool.space* через сеть Tor.
![Ссылка Mempool](assets/notext/41.webp)
Я советую сохранить эту ссылку в избранном в браузере Tor или добавить ее в приложение Tor Browser на вашем смартфоне для удобного и безопасного доступа откуда угодно. Если у вас еще нет браузера Tor, вы можете скачать его здесь: [https://www.torproject.org/download/](https://www.torproject.org/download/)
![Mempool Tor](assets/notext/42.webp)

### Использование Whirlpool для смешивания ваших биткойнов
Ваш узел RoninDojo также интегрирует _WhirlpoolCLI_, интерфейс командной строки, который позволяет автоматизировать смешивание монет через Whirlpool, и _WhirlpoolGUI_, графический интерфейс, предназначенный для взаимодействия с _WhirlpoolCLI_.
Выполнение coinjoin через Whirlpool требует, чтобы приложение, используемое для этого, было активно для проведения ремиксов. Это условие может быть ограничивающим для тех, кто желает достичь высоких уровней анонимности. Действительно, устройство, на котором установлено приложение, интегрирующее Whirlpool, должно оставаться включенным непрерывно. Это означает, что для участия в ремиксах 24 часа в сутки ваш компьютер или смартфон должен оставаться включенным с постоянно открытым Samourai или Sparrow. Решением этой проблемы является использование _WhirlpoolCLI_ на машине, которая всегда включена, например, на Bitcoin ноде, что позволяет вашим монетам участвовать в ремиксах без перерывов и без необходимости держать другое устройство включенным.
Подробный учебник готовится, чтобы пошагово руководить вас через процесс совместного использования монет с помощью Samourai Wallet и RoninDojo v2, от А до Я.

Для более глубокого понимания coinjoin и его использования в Bitcoin, я также приглашаю вас ознакомиться с другой статьей: Понимание и использование coinjoin в Bitcoin, где я детально рассказываю все, что вам нужно знать об этой технике.

https://planb.network/tutorials/privacy/coinjoin-dojo
### Использование инструмента Whirlpool Stat Tool (WST)

После выполнения coinjoins с Whirlpool полезно точно оценить достигнутый уровень конфиденциальности для ваших смешанных UTXO. Для этого вы можете использовать инструмент на Python *Whirlpool Stat Tool*. Этот инструмент позволяет измерять как перспективные, так и ретроспективные оценки ваших UTXO, анализируя их скорость распространения в пуле.

Для углубленного понимания механизмов расчета этих анонимных наборов, я рекомендую прочитать статью: REMIX - WHIRLPOOL, которая детально описывает функционирование этих индексов.

https://planb.network/tutorials/privacy/remix-whirlpool



Чтобы получить доступ к инструменту WST, перейдите к RoninCLI. Для этого откройте терминал на вашем личном компьютере и установите SSH-соединение с вашей нодой, используя следующую команду:
`SSH ronindojo@[IP]`

Если, например, IP-адрес вашей ноды `192.168.1.40`, соответствующая команда будет:
`SSH ronindojo@192.168.1.40`

Если вы изменили свое имя пользователя на шаге 6, заменив стандартное имя пользователя (`ronindojo`) на другое, убедитесь, что используете это новое имя в команде. Например, если вы выбрали `planb` в качестве вашего имени пользователя и IP-адрес `192.168.1.40`, команда для ввода будет:
`SSH planb@192.168.1.40`

Вас попросят ввести пароль пользователя. Введите его и нажмите `enter`, чтобы подтвердить. Затем вы получите доступ к интерфейсу RoninCLI. Используйте стрелки на клавиатуре для навигации к меню `Samourai Toolkit` и нажмите `enter`, чтобы выбрать его:

![Samourai Toolkit](assets/notext/43.webp)

Затем выберите `Whirlpool Stat Tool`:

![WST](assets/notext/44.webp)

При инициализации WST инструмент начнет автоматическую установку. Подождите во время этого шага. Инструкции по использованию будут прокручиваться. После завершения установки нажмите любую клавишу, чтобы получить доступ к терминалу WST:

![WST commands](assets/notext/45.webp)

Будет отображена следующая командная строка:
`wst#/tmp>`

Если вы хотите выйти из этого интерфейса и вернуться в меню RoninCLI, просто введите:
`quit`

Сначала необходимо настроить прокси для использования Tor, чтобы обеспечить конфиденциальность при извлечении данных из OXT. Введите команду:
`socks5 127.0.0.1:9050`
Затем приступите к загрузке информации о пуле, содержащей вашу транзакцию:
`download 0001`
Замените `0001` на код номинала пула, который вас интересует. Коды номиналов следующие на WST:
- Пул 0.5 биткоинов: `05`
- Пул 0.05 биткоинов: `005`
- Пул 0.01 биткоинов: `001`
- Пул 0.001 биткоинов: `0001`

После загрузки загрузите данные, заменив `0001` на код вашего пула в этой команде: `load 0001`

![WST загрузка](assets/notext/46.webp)

Ожидайте завершения загрузки, что может занять несколько минут. Как только данные будут загружены, чтобы узнать оценки анонимности вашей монеты, выполните команду `score` с вашим TXID (без скобок):
`score [TXID]`

![WST оценка](assets/notext/47.webp)

WST затем отобразит ретроспективную оценку (_Метрики, оглядывающиеся назад_), за которой следует перспективная оценка (_Метрики, смотрящие вперед_). Помимо оценок анонимности, WST также укажет скорость распространения вашей транзакции внутри пула по отношению к ее анонимности.

**Важно отметить, что перспективная оценка вашей монеты должна быть рассчитана из TXID вашего первоначального микса, а не из вашего последнего микса. В свою очередь, ретроспективная оценка UTXO рассчитывается из TXID последнего цикла.**

### Использование калькулятора Больцмана
Калькулятор Больцмана - это инструмент для анализа биткоин-транзакции, предлагающий возможность измерить ее уровень энтропии среди других продвинутых метрик. Эти данные предоставляют количественную оценку конфиденциальности транзакции и помогают выявить потенциальные недостатки. Этот инструмент уже интегрирован в ваш узел RoninDojo, что облегчает доступ и использование.

Прежде чем подробно описывать процедуру использования калькулятора Больцмана, важно понимать значение этих индикаторов, метод их расчета и их полезность. Хотя эти индикаторы применимы к любой биткоин-транзакции, они особенно полезны для оценки качества транзакции coinjoin.

**Первый индикатор**, который рассчитывает программное обеспечение, - это общее количество возможных комбинаций, указанное под `nb combinations` в инструменте. Исходя из значений задействованных UTXO, этот индикатор количественно определяет количество способов, которыми входы могут быть связаны с выходами. Другими словами, он определяет количество правдоподобных интерпретаций, которые может генерировать транзакция. Например, coinjoin, структурированный в соответствии с моделью Whirlpool 5x5, представляет `1496` возможных комбинаций:
![комбинации](assets/notext/50.webp)
Кредит: KYCP

**Второй индикатор**, который рассчитывается, - это энтропия транзакции, обозначаемая как `Entropy`. Когда транзакция имеет большое количество возможных комбинаций, часто более релевантно ссылаться на ее энтропию. Это определяется как двоичный логарифм количества возможных комбинаций. Вот используемая формула:
- $E$: энтропия транзакции;
- $C$: количество возможных комбинаций для транзакции.
$$E = \log_2(C)$$
В математике бинарный логарифм (логарифм по основанию 2) соответствует обратной операции возведения 2 в степень. Другими словами, бинарный логарифм от $x$ — это показатель степени, в которую необходимо возвести 2, чтобы получить $x$. Следовательно, этот показатель выражается в битах. Рассмотрим пример расчета энтропии для транзакции coinjoin, структурированной согласно модели Whirlpool 5x5, которая, как упоминалось ранее, предлагает количество возможных комбинаций `1496`:$$ C = 1496 $$
$$ E = \log_2(1496) $$
$$ E \approx 10.5469 \text{ бит}$$

Таким образом, эта транзакция coinjoin демонстрирует энтропию в 10.5469 бит, что считается очень удовлетворительным. Чем выше это значение, тем больше различных интерпретаций допускает транзакция, тем самым повышая ее уровень приватности.

Рассмотрим дополнительный пример с более традиционной транзакцией, имеющей один вход и два выхода: [1b1b0c3f0883a99f1161c64da19471841ed12a1f78e77fab128c69a5f578ccce](https://mempool.space/en/tx/1b1b0c3f0883a99f1161c64da19471841ed12a1f78e77fab128c69a5f578ccce)
В случае этой транзакции единственно возможная интерпретация: `(inp 0) > (Outp 0 ; Outp 1)`. Следовательно, ее энтропия устанавливается в `0`:
$$ C = 1 $$
$$ E = \log_2(1) $$
$$ E \approx 0 \text{ бит}$$
**Третий показатель**, предоставляемый Калькулятором Больцмана, называется `Эффективность кошелька`. Этот показатель оценивает эффективность транзакции, сравнивая ее с оптимальной транзакцией, возможной в аналогичной ситуации. Это приводит нас к обсуждению концепции максимальной энтропии, которая соответствует наивысшей энтропии, которую конкретная структура транзакции может теоретически достичь. Таким образом, для структуры coinjoin Whirlpool 5x5 максимальная энтропия установлена в `10.5469`. Эффективность транзакции затем рассчитывается путем сравнения этой максимальной энтропии с фактической энтропией анализируемой транзакции. Используемая формула следующая:
- $ER$: фактическая энтропия транзакции, выраженная в битах;
- $EM$: максимально возможная энтропия для данной структуры транзакции, также в битах;
- $Ef$: эффективность транзакции, в битах.
$$Ef = ER - EM$$ $$Ef = 10.5469 - 10.5469$$
$$Ef = 0 \text{ бит}$$

Этот показатель также выражается в процентах, его формула тогда:
- $CR$: количество фактически возможных комбинаций;
- $CM$: максимальное количество возможных комбинаций при той же структуре;
- $Ef$: эффективность, выраженная в процентах.
$$Ef = \frac{CR}{CM}$$
$$Ef = \frac{1496}{1496}$$
$$Ef = 100\%$$

Таким образом, эффективность в `100%` указывает на то, что транзакция максимизирует свой потенциал для приватности на основе своей структуры.
**Четвертый показатель**, плотность энтропии, или `Entropy Density`, предлагает взглянуть на энтропию относительно каждого входа или выхода транзакции. Этот показатель полезен для оценки и сравнения эффективности транзакций разного размера. Для его расчета просто разделите общую энтропию транзакции на общее количество входов и выходов, участвующих в ней. Возьмем в качестве примера Whirlpool 5x5 coinjoin:
- $ED$: плотность энтропии, выраженная в битах;
- $E$: энтропия транзакции, выраженная в битах;
- $T$: общее количество входов и выходов в транзакции.
$$T = 5 + 5 = 10$$
$$ED = \frac{E}{T}$$
$$ED = \frac{10.5469}{10}$$
$$ED = 1.054 \text{ бит}$$
**Пятая информация**, предоставляемая Калькулятором Больцмана, - это таблица вероятностей соответствия между входами и выходами. Эта таблица указывает, через `Boltzmann score`, вероятность того, что конкретный вход связан с данным выходом. Взяв в качестве примера Whirlpool coinjoin, таблица вероятностей подчеркнет шансы связи между каждым входом и выходом, предоставляя количественную меру неоднозначности или предсказуемости ассоциаций в транзакции:

| %       | Выход 0 | Выход 1 | Выход 2 | Выход 3 | Выход 4 |
|---------|---------|---------|---------|---------|---------|
| Вход 0  | 34%     | 34%     | 34%     | 34%     | 34%     |
| Вход 1  | 34%     | 34%     | 34%     | 34%     | 34%     |
| Вход 2  | 34%     | 34%     | 34%     | 34%     | 34%     |
| Вход 3  | 34%     | 34%     | 34%     | 34%     | 34%     |
| Вход 4  | 34%     | 34%     | 34%     | 34%     | 34%     |

Здесь ясно, что каждый вход имеет равные шансы быть связанным с любым выходом, что усиливает неоднозначность и конфиденциальность транзакции. Однако, в случае простой транзакции с одним входом и двумя выходами, ситуация другая:

| %       | Выход 0 | Выход 1 |
|---------|---------|---------|
| Вход 0  | 100%    | 100%    |

Здесь мы видим, что вероятность для каждого выхода происходить от входа 0 составляет 100%. Меньшая вероятность таким образом переводится в большую конфиденциальность, размывая прямые связи между входами и выходами.

**Шестая информация**, предоставляемая, - это количество детерминированных связей, дополненное соотношением этих связей. Этот показатель раскрывает, сколько связей между входами и выходами в анализируемой транзакции являются неоспоримыми, с вероятностью 100%. Соотношение, в свою очередь, предлагает перспективу веса этих детерминированных связей в общем количестве связей транзакции.

Например, транзакция типа Whirlpool coinjoin представляет собой ноль детерминированных связей, и, следовательно, показывает показатель и соотношение 0%. С другой стороны, в нашей второй рассмотренной транзакции (с одним входом и двумя выходами) показатель установлен на 2, а соотношение достигает 100%. Таким образом, нулевой показатель сигнализирует об отличной конфиденциальности благодаря отсутствию прямых и неоспоримых связей между входами и выходами.
**Как получить доступ к Калькулятору Больцмана на RoninDojo?** Чтобы получить доступ к инструменту *Калькулятор Больцмана*, перейдите в RoninCLI. Для этого откройте терминал на вашем персональном компьютере и установите SSH-соединение с вашим узлом, используя следующую команду: `SSH ronindojo@[IP]`

Если, например, IP-адрес вашего узла `192.168.1.40`, соответствующая команда будет:
`SSH ronindojo@192.168.1.40`

Если вы изменили свое имя пользователя на шаге 6, заменив стандартное имя пользователя (`ronindojo`) на другое, убедитесь, что используете это новое имя в команде. Например, если вы выбрали `planb` в качестве имени пользователя и IP-адрес `192.168.1.40`, команда для ввода будет:
`SSH planb@192.168.1.40`

Вас попросят ввести пароль пользователя. Введите его, а затем нажмите `enter`, чтобы подтвердить. После этого вы получите доступ к интерфейсу RoninCLI. Используйте стрелки на клавиатуре для навигации к меню `Samourai Toolkit` и нажмите `enter`, чтобы выбрать его:

![Samourai Toolkit](assets/notext/43.webp)

Затем выберите `Boltzmann Calculator`:

![boltzmann](assets/notext/49.webp)

Вы попадете на домашнюю страницу программы:

![boltzmann home](assets/notext/51.webp)

Введите TXID транзакции, которую вы хотите изучить, и нажмите клавишу `enter`:

![boltzmann txid](assets/notext/52.webp)

Затем калькулятор предоставит вам все индикаторы, о которых мы ранее говорили:

![boltzmann result](assets/notext/53.webp)

### Другие функции вашего RoninDojo v2
Ваш узел RoninDojo интегрирует различные другие функции. В частности, у вас есть возможность сканировать определенную информацию для ее учета. Например, иногда ваш кошелек Samourai, подключенный к RoninDojo, может не отображать биткойны, которые у вас на самом деле есть. Если баланс показывает 0, в то время как вы уверены, что в этом кошельке есть биткойны, несколько причин могут объяснить эту ситуацию, такие как ошибка в путях производных. Но одной из причин также может быть то, что ваш узел не должным образом отслеживает ваши адреса. Чтобы решить эту проблему, вы можете убедиться, что ваш узел действительно следит за вашим `xpub`, используя инструмент _xpub tool_. Чтобы получить доступ к этому инструменту через RoninUI, следуйте пути:
`Maintenance > XPUB Tool`

Введите `xpub`, который вызывает проблему, и нажмите кнопку `Check`, чтобы проверить эту информацию:
![xpub tool](assets/notext/54.webp)
Убедитесь, что все транзакции должным образом перечислены. Также важно проверить, соответствует ли используемый тип производных вашему кошельку. Если это не так, нажмите на `Retype`, затем выберите из `BIP44`, `BIP49` или `BIP84` в соответствии с вашими потребностями.
Помимо этого инструмента, вкладка `Maintenance` в RoninUI полна других полезных функций:
- *Transaction Tool*: Позволяет изучить детали данной транзакции;
- *Address Tool*: Позволяет подтвердить отслеживание данного адреса вашим Dojo;
- *Rescan Blocks*: Заставляет ваш узел выполнить новое сканирование указанного диапазона блоков.

Вкладка `Push Tx` - еще одна интересная функция RoninUI, которая позволяет транслировать подписанную транзакцию в сети Bitcoin. Транзакция должна быть введена в шестнадцатеричной форме.
Относительно других вкладок, доступных на вашей панели управления RoninUI:
- `Apps`: Содержит приложение Whirlpool и, безусловно, будет использоваться для интеграции новых приложений в будущем;
- `Logs`: Предоставляет доступ в реальном времени к журналам событий вашего программного обеспечения;
- `System Info`: Предоставляет общую информацию о вашем узле, такую как температура CPU, использование места на диске или данные о RAM. Здесь вы также найдете опции `Reboot` и `Shut down` для перезагрузки или выключения вашего узла;
- `Settings`: Позволяет изменить пароль пользователя.

Вот и все! Спасибо, что следовали этому руководству до конца. Если оно вам понравилось, я призываю вас поделиться им в социальных сетях. Кроме того, если у вас есть возможность, рассмотрите вариант поддержки разработчиков, которые делают эти бесплатные и открытые программные обеспечения доступными для нашего сообщества путем пожертвования: [https://donate.ronindojo.io/](https://donate.ronindojo.io/). Чтобы углубить свои знания о RoninDojo и открыть для себя больше ресурсов, я настоятельно рекомендую проконсультироваться со ссылками на внешние ресурсы, упомянутые ниже.

**Внешние ресурсы:**
- [https://ronindojo.io/index.html](https://ronindojo.io/index.html)
- [https://wiki.ronindojo.io/en/home](https://wiki.ronindojo.io/en/home)
- [https://gist.github.com/LaurentMT/e758767ca4038ac40aaf](https://gist.github.com/LaurentMT/e758767ca4038ac40aaf)
- [https://medium.com/@laurentmt/introducing-boltzmann-85930984a159](https://medium.com/@laurentmt/introducing-boltzmann-85930984a159)
- [https://wiki.ronindojo.io/en/setup/V2_0_0-upgrade-raspberry](https://wiki.ronindojo.io/en/setup/V2_0_0-upgrade-raspberry)